<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kong package &mdash; kong-pdk  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> kong-pdk
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">kong package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-kong.cluster">kong.cluster module</a><ul>
<li><a class="reference internal" href="#kong.cluster.cluster"><code class="docutils literal notranslate"><span class="pre">cluster</span></code></a><ul>
<li><a class="reference internal" href="#kong.cluster.cluster.get_id"><code class="docutils literal notranslate"><span class="pre">cluster.get_id()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.ip">kong.ip module</a><ul>
<li><a class="reference internal" href="#kong.ip.ip"><code class="docutils literal notranslate"><span class="pre">ip</span></code></a><ul>
<li><a class="reference internal" href="#kong.ip.ip.is_trusted"><code class="docutils literal notranslate"><span class="pre">ip.is_trusted()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.log">kong.log module</a><ul>
<li><a class="reference internal" href="#kong.log.log"><code class="docutils literal notranslate"><span class="pre">log</span></code></a><ul>
<li><a class="reference internal" href="#kong.log.log.alert"><code class="docutils literal notranslate"><span class="pre">log.alert()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.crit"><code class="docutils literal notranslate"><span class="pre">log.crit()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.debug"><code class="docutils literal notranslate"><span class="pre">log.debug()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.deprecation"><code class="docutils literal notranslate"><span class="pre">log.deprecation()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.err"><code class="docutils literal notranslate"><span class="pre">log.err()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.info"><code class="docutils literal notranslate"><span class="pre">log.info()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.notice"><code class="docutils literal notranslate"><span class="pre">log.notice()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.serialize"><code class="docutils literal notranslate"><span class="pre">log.serialize()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.set_serialize_value"><code class="docutils literal notranslate"><span class="pre">log.set_serialize_value()</span></code></a></li>
<li><a class="reference internal" href="#kong.log.log.warn"><code class="docutils literal notranslate"><span class="pre">log.warn()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.node">kong.node module</a><ul>
<li><a class="reference internal" href="#kong.node.node"><code class="docutils literal notranslate"><span class="pre">node</span></code></a><ul>
<li><a class="reference internal" href="#kong.node.node.get_hostname"><code class="docutils literal notranslate"><span class="pre">node.get_hostname()</span></code></a></li>
<li><a class="reference internal" href="#kong.node.node.get_id"><code class="docutils literal notranslate"><span class="pre">node.get_id()</span></code></a></li>
<li><a class="reference internal" href="#kong.node.node.get_memory_stats"><code class="docutils literal notranslate"><span class="pre">node.get_memory_stats()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.request">kong.request module</a><ul>
<li><a class="reference internal" href="#kong.request.request"><code class="docutils literal notranslate"><span class="pre">request</span></code></a><ul>
<li><a class="reference internal" href="#kong.request.request.get_body"><code class="docutils literal notranslate"><span class="pre">request.get_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_forwarded_host"><code class="docutils literal notranslate"><span class="pre">request.get_forwarded_host()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_forwarded_path"><code class="docutils literal notranslate"><span class="pre">request.get_forwarded_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_forwarded_port"><code class="docutils literal notranslate"><span class="pre">request.get_forwarded_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_forwarded_prefix"><code class="docutils literal notranslate"><span class="pre">request.get_forwarded_prefix()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_forwarded_scheme"><code class="docutils literal notranslate"><span class="pre">request.get_forwarded_scheme()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_header"><code class="docutils literal notranslate"><span class="pre">request.get_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_headers"><code class="docutils literal notranslate"><span class="pre">request.get_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_host"><code class="docutils literal notranslate"><span class="pre">request.get_host()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_http_version"><code class="docutils literal notranslate"><span class="pre">request.get_http_version()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_method"><code class="docutils literal notranslate"><span class="pre">request.get_method()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_path"><code class="docutils literal notranslate"><span class="pre">request.get_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_path_with_query"><code class="docutils literal notranslate"><span class="pre">request.get_path_with_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_port"><code class="docutils literal notranslate"><span class="pre">request.get_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_query"><code class="docutils literal notranslate"><span class="pre">request.get_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_query_arg"><code class="docutils literal notranslate"><span class="pre">request.get_query_arg()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_raw_body"><code class="docutils literal notranslate"><span class="pre">request.get_raw_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_raw_path"><code class="docutils literal notranslate"><span class="pre">request.get_raw_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_raw_query"><code class="docutils literal notranslate"><span class="pre">request.get_raw_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_scheme"><code class="docutils literal notranslate"><span class="pre">request.get_scheme()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_start_time"><code class="docutils literal notranslate"><span class="pre">request.get_start_time()</span></code></a></li>
<li><a class="reference internal" href="#kong.request.request.get_uri_captures"><code class="docutils literal notranslate"><span class="pre">request.get_uri_captures()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.response">kong.response module</a><ul>
<li><a class="reference internal" href="#kong.response.response"><code class="docutils literal notranslate"><span class="pre">response</span></code></a><ul>
<li><a class="reference internal" href="#kong.response.response.add_header"><code class="docutils literal notranslate"><span class="pre">response.add_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.clear_header"><code class="docutils literal notranslate"><span class="pre">response.clear_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.error"><code class="docutils literal notranslate"><span class="pre">response.error()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.exit"><code class="docutils literal notranslate"><span class="pre">response.exit()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.get_header"><code class="docutils literal notranslate"><span class="pre">response.get_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.get_headers"><code class="docutils literal notranslate"><span class="pre">response.get_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.get_source"><code class="docutils literal notranslate"><span class="pre">response.get_source()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.get_status"><code class="docutils literal notranslate"><span class="pre">response.get_status()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.set_header"><code class="docutils literal notranslate"><span class="pre">response.set_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.set_headers"><code class="docutils literal notranslate"><span class="pre">response.set_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.response.response.set_status"><code class="docutils literal notranslate"><span class="pre">response.set_status()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.router">kong.router module</a><ul>
<li><a class="reference internal" href="#kong.router.router"><code class="docutils literal notranslate"><span class="pre">router</span></code></a><ul>
<li><a class="reference internal" href="#kong.router.router.get_route"><code class="docutils literal notranslate"><span class="pre">router.get_route()</span></code></a></li>
<li><a class="reference internal" href="#kong.router.router.get_service"><code class="docutils literal notranslate"><span class="pre">router.get_service()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong.vault">kong.vault module</a><ul>
<li><a class="reference internal" href="#kong.vault.vault"><code class="docutils literal notranslate"><span class="pre">vault</span></code></a><ul>
<li><a class="reference internal" href="#kong.vault.vault.get"><code class="docutils literal notranslate"><span class="pre">vault.get()</span></code></a></li>
<li><a class="reference internal" href="#kong.vault.vault.is_reference"><code class="docutils literal notranslate"><span class="pre">vault.is_reference()</span></code></a></li>
<li><a class="reference internal" href="#kong.vault.vault.parse_reference"><code class="docutils literal notranslate"><span class="pre">vault.parse_reference()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-kong">Module contents</a><ul>
<li><a class="reference internal" href="#kong.kong"><code class="docutils literal notranslate"><span class="pre">kong</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.client"><code class="docutils literal notranslate"><span class="pre">kong.client</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.client.authenticate"><code class="docutils literal notranslate"><span class="pre">kong.client.authenticate()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_consumer"><code class="docutils literal notranslate"><span class="pre">kong.client.get_consumer()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_credential"><code class="docutils literal notranslate"><span class="pre">kong.client.get_credential()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_forwarded_ip"><code class="docutils literal notranslate"><span class="pre">kong.client.get_forwarded_ip()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_forwarded_port"><code class="docutils literal notranslate"><span class="pre">kong.client.get_forwarded_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_ip"><code class="docutils literal notranslate"><span class="pre">kong.client.get_ip()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_port"><code class="docutils literal notranslate"><span class="pre">kong.client.get_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.get_protocol"><code class="docutils literal notranslate"><span class="pre">kong.client.get_protocol()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.load_consumer"><code class="docutils literal notranslate"><span class="pre">kong.client.load_consumer()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.tls"><code class="docutils literal notranslate"><span class="pre">kong.client.tls</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.client.tls.disable_session_reuse"><code class="docutils literal notranslate"><span class="pre">kong.client.tls.disable_session_reuse()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.tls.get_full_client_certificate_chain"><code class="docutils literal notranslate"><span class="pre">kong.client.tls.get_full_client_certificate_chain()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.tls.request_client_certificate"><code class="docutils literal notranslate"><span class="pre">kong.client.tls.request_client_certificate()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.client.tls.set_client_verify"><code class="docutils literal notranslate"><span class="pre">kong.client.tls.set_client_verify()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.cluster"><code class="docutils literal notranslate"><span class="pre">kong.cluster</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.cluster.get_id"><code class="docutils literal notranslate"><span class="pre">kong.cluster.get_id()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.ctx"><code class="docutils literal notranslate"><span class="pre">kong.ctx</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.ctx.shared"><code class="docutils literal notranslate"><span class="pre">kong.ctx.shared</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.ctx.shared.get"><code class="docutils literal notranslate"><span class="pre">kong.ctx.shared.get()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.ctx.shared.set"><code class="docutils literal notranslate"><span class="pre">kong.ctx.shared.set()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.ip"><code class="docutils literal notranslate"><span class="pre">kong.ip</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.ip.is_trusted"><code class="docutils literal notranslate"><span class="pre">kong.ip.is_trusted()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.log"><code class="docutils literal notranslate"><span class="pre">kong.log</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.log.alert"><code class="docutils literal notranslate"><span class="pre">kong.log.alert()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.crit"><code class="docutils literal notranslate"><span class="pre">kong.log.crit()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.debug"><code class="docutils literal notranslate"><span class="pre">kong.log.debug()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.deprecation"><code class="docutils literal notranslate"><span class="pre">kong.log.deprecation()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.err"><code class="docutils literal notranslate"><span class="pre">kong.log.err()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.info"><code class="docutils literal notranslate"><span class="pre">kong.log.info()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.notice"><code class="docutils literal notranslate"><span class="pre">kong.log.notice()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.serialize"><code class="docutils literal notranslate"><span class="pre">kong.log.serialize()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.set_serialize_value"><code class="docutils literal notranslate"><span class="pre">kong.log.set_serialize_value()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.log.warn"><code class="docutils literal notranslate"><span class="pre">kong.log.warn()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.nginx"><code class="docutils literal notranslate"><span class="pre">kong.nginx</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.nginx.get_ctx"><code class="docutils literal notranslate"><span class="pre">kong.nginx.get_ctx()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.get_statistics"><code class="docutils literal notranslate"><span class="pre">kong.nginx.get_statistics()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.get_subsystem"><code class="docutils literal notranslate"><span class="pre">kong.nginx.get_subsystem()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.get_tls1_version_str"><code class="docutils literal notranslate"><span class="pre">kong.nginx.get_tls1_version_str()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.get_var"><code class="docutils literal notranslate"><span class="pre">kong.nginx.get_var()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.req_start_time"><code class="docutils literal notranslate"><span class="pre">kong.nginx.req_start_time()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.set_ctx"><code class="docutils literal notranslate"><span class="pre">kong.nginx.set_ctx()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.shared"><code class="docutils literal notranslate"><span class="pre">kong.nginx.shared</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.nginx.shared.get"><code class="docutils literal notranslate"><span class="pre">kong.nginx.shared.get()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.nginx.shared.set"><code class="docutils literal notranslate"><span class="pre">kong.nginx.shared.set()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.node"><code class="docutils literal notranslate"><span class="pre">kong.node</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.node.get_hostname"><code class="docutils literal notranslate"><span class="pre">kong.node.get_hostname()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.node.get_id"><code class="docutils literal notranslate"><span class="pre">kong.node.get_id()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.node.get_memory_stats"><code class="docutils literal notranslate"><span class="pre">kong.node.get_memory_stats()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.request"><code class="docutils literal notranslate"><span class="pre">kong.request</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.request.get_body"><code class="docutils literal notranslate"><span class="pre">kong.request.get_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_forwarded_host"><code class="docutils literal notranslate"><span class="pre">kong.request.get_forwarded_host()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_forwarded_path"><code class="docutils literal notranslate"><span class="pre">kong.request.get_forwarded_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_forwarded_port"><code class="docutils literal notranslate"><span class="pre">kong.request.get_forwarded_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_forwarded_prefix"><code class="docutils literal notranslate"><span class="pre">kong.request.get_forwarded_prefix()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_forwarded_scheme"><code class="docutils literal notranslate"><span class="pre">kong.request.get_forwarded_scheme()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_header"><code class="docutils literal notranslate"><span class="pre">kong.request.get_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_headers"><code class="docutils literal notranslate"><span class="pre">kong.request.get_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_host"><code class="docutils literal notranslate"><span class="pre">kong.request.get_host()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_http_version"><code class="docutils literal notranslate"><span class="pre">kong.request.get_http_version()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_method"><code class="docutils literal notranslate"><span class="pre">kong.request.get_method()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_path"><code class="docutils literal notranslate"><span class="pre">kong.request.get_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_path_with_query"><code class="docutils literal notranslate"><span class="pre">kong.request.get_path_with_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_port"><code class="docutils literal notranslate"><span class="pre">kong.request.get_port()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_query"><code class="docutils literal notranslate"><span class="pre">kong.request.get_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_query_arg"><code class="docutils literal notranslate"><span class="pre">kong.request.get_query_arg()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_raw_body"><code class="docutils literal notranslate"><span class="pre">kong.request.get_raw_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_raw_path"><code class="docutils literal notranslate"><span class="pre">kong.request.get_raw_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_raw_query"><code class="docutils literal notranslate"><span class="pre">kong.request.get_raw_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_scheme"><code class="docutils literal notranslate"><span class="pre">kong.request.get_scheme()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_start_time"><code class="docutils literal notranslate"><span class="pre">kong.request.get_start_time()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.request.get_uri_captures"><code class="docutils literal notranslate"><span class="pre">kong.request.get_uri_captures()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.response"><code class="docutils literal notranslate"><span class="pre">kong.response</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.response.add_header"><code class="docutils literal notranslate"><span class="pre">kong.response.add_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.clear_header"><code class="docutils literal notranslate"><span class="pre">kong.response.clear_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.error"><code class="docutils literal notranslate"><span class="pre">kong.response.error()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.exit"><code class="docutils literal notranslate"><span class="pre">kong.response.exit()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.get_header"><code class="docutils literal notranslate"><span class="pre">kong.response.get_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.get_headers"><code class="docutils literal notranslate"><span class="pre">kong.response.get_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.get_source"><code class="docutils literal notranslate"><span class="pre">kong.response.get_source()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.get_status"><code class="docutils literal notranslate"><span class="pre">kong.response.get_status()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.set_header"><code class="docutils literal notranslate"><span class="pre">kong.response.set_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.set_headers"><code class="docutils literal notranslate"><span class="pre">kong.response.set_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.response.set_status"><code class="docutils literal notranslate"><span class="pre">kong.response.set_status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.router"><code class="docutils literal notranslate"><span class="pre">kong.router</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.router.get_route"><code class="docutils literal notranslate"><span class="pre">kong.router.get_route()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.router.get_service"><code class="docutils literal notranslate"><span class="pre">kong.router.get_service()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.service"><code class="docutils literal notranslate"><span class="pre">kong.service</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.service.request"><code class="docutils literal notranslate"><span class="pre">kong.service.request</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.service.request.add_header"><code class="docutils literal notranslate"><span class="pre">kong.service.request.add_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.clear_header"><code class="docutils literal notranslate"><span class="pre">kong.service.request.clear_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.disable_tls"><code class="docutils literal notranslate"><span class="pre">kong.service.request.disable_tls()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.enable_buffering"><code class="docutils literal notranslate"><span class="pre">kong.service.request.enable_buffering()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_body"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_header"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_headers"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_method"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_method()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_path"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_path()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_query"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_raw_body"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_raw_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_raw_query"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_raw_query()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.request.set_scheme"><code class="docutils literal notranslate"><span class="pre">kong.service.request.set_scheme()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.service.response"><code class="docutils literal notranslate"><span class="pre">kong.service.response</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.service.response.get_body"><code class="docutils literal notranslate"><span class="pre">kong.service.response.get_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.response.get_header"><code class="docutils literal notranslate"><span class="pre">kong.service.response.get_header()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.response.get_headers"><code class="docutils literal notranslate"><span class="pre">kong.service.response.get_headers()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.response.get_raw_body"><code class="docutils literal notranslate"><span class="pre">kong.service.response.get_raw_body()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.response.get_status"><code class="docutils literal notranslate"><span class="pre">kong.service.response.get_status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.service.set_target"><code class="docutils literal notranslate"><span class="pre">kong.service.set_target()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.set_tls_verify"><code class="docutils literal notranslate"><span class="pre">kong.service.set_tls_verify()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.set_tls_verify_depth"><code class="docutils literal notranslate"><span class="pre">kong.service.set_tls_verify_depth()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.service.set_upstream"><code class="docutils literal notranslate"><span class="pre">kong.service.set_upstream()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kong.kong.vault"><code class="docutils literal notranslate"><span class="pre">kong.vault</span></code></a><ul>
<li><a class="reference internal" href="#kong.kong.vault.get"><code class="docutils literal notranslate"><span class="pre">kong.vault.get()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.vault.is_reference"><code class="docutils literal notranslate"><span class="pre">kong.vault.is_reference()</span></code></a></li>
<li><a class="reference internal" href="#kong.kong.vault.parse_reference"><code class="docutils literal notranslate"><span class="pre">kong.vault.parse_reference()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kong-pdk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>kong package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/kong.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kong-package">
<h1>kong package<a class="headerlink" href="#kong-package" title="Permalink to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="kong.client.html">kong.client package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kong.client.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="kong.client.html#module-kong.client.tls">kong.client.tls module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.client.html#kong.client.tls.tls"><code class="docutils literal notranslate"><span class="pre">tls</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.tls.tls.disable_session_reuse"><code class="docutils literal notranslate"><span class="pre">tls.disable_session_reuse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.tls.tls.get_full_client_certificate_chain"><code class="docutils literal notranslate"><span class="pre">tls.get_full_client_certificate_chain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.tls.tls.request_client_certificate"><code class="docutils literal notranslate"><span class="pre">tls.request_client_certificate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.tls.tls.set_client_verify"><code class="docutils literal notranslate"><span class="pre">tls.set_client_verify()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kong.client.html#module-kong.client">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.client.html#kong.client.client"><code class="docutils literal notranslate"><span class="pre">client</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.authenticate"><code class="docutils literal notranslate"><span class="pre">client.authenticate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_consumer"><code class="docutils literal notranslate"><span class="pre">client.get_consumer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_credential"><code class="docutils literal notranslate"><span class="pre">client.get_credential()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_forwarded_ip"><code class="docutils literal notranslate"><span class="pre">client.get_forwarded_ip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_forwarded_port"><code class="docutils literal notranslate"><span class="pre">client.get_forwarded_port()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_ip"><code class="docutils literal notranslate"><span class="pre">client.get_ip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_port"><code class="docutils literal notranslate"><span class="pre">client.get_port()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.get_protocol"><code class="docutils literal notranslate"><span class="pre">client.get_protocol()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.load_consumer"><code class="docutils literal notranslate"><span class="pre">client.load_consumer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.client.html#kong.client.client.tls"><code class="docutils literal notranslate"><span class="pre">client.tls</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kong.ctx.html">kong.ctx package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kong.ctx.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="kong.ctx.html#module-kong.ctx.shared">kong.ctx.shared module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.ctx.html#kong.ctx.shared.shared"><code class="docutils literal notranslate"><span class="pre">shared</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.ctx.html#kong.ctx.shared.shared.get"><code class="docutils literal notranslate"><span class="pre">shared.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.ctx.html#kong.ctx.shared.shared.set"><code class="docutils literal notranslate"><span class="pre">shared.set()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kong.ctx.html#module-kong.ctx">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.ctx.html#kong.ctx.ctx"><code class="docutils literal notranslate"><span class="pre">ctx</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.ctx.html#kong.ctx.ctx.shared"><code class="docutils literal notranslate"><span class="pre">ctx.shared</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kong.nginx.html">kong.nginx package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kong.nginx.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="kong.nginx.html#module-kong.nginx.shared">kong.nginx.shared module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.nginx.html#kong.nginx.shared.shared"><code class="docutils literal notranslate"><span class="pre">shared</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.shared.shared.get"><code class="docutils literal notranslate"><span class="pre">shared.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.shared.shared.set"><code class="docutils literal notranslate"><span class="pre">shared.set()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kong.nginx.html#module-kong.nginx">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx"><code class="docutils literal notranslate"><span class="pre">nginx</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.get_ctx"><code class="docutils literal notranslate"><span class="pre">nginx.get_ctx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.get_statistics"><code class="docutils literal notranslate"><span class="pre">nginx.get_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.get_subsystem"><code class="docutils literal notranslate"><span class="pre">nginx.get_subsystem()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.get_tls1_version_str"><code class="docutils literal notranslate"><span class="pre">nginx.get_tls1_version_str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.get_var"><code class="docutils literal notranslate"><span class="pre">nginx.get_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.req_start_time"><code class="docutils literal notranslate"><span class="pre">nginx.req_start_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.set_ctx"><code class="docutils literal notranslate"><span class="pre">nginx.set_ctx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.nginx.html#kong.nginx.nginx.shared"><code class="docutils literal notranslate"><span class="pre">nginx.shared</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kong.service.html">kong.service package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kong.service.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="kong.service.html#module-kong.service.request">kong.service.request module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.service.html#kong.service.request.request"><code class="docutils literal notranslate"><span class="pre">request</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.add_header"><code class="docutils literal notranslate"><span class="pre">request.add_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.clear_header"><code class="docutils literal notranslate"><span class="pre">request.clear_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.disable_tls"><code class="docutils literal notranslate"><span class="pre">request.disable_tls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.enable_buffering"><code class="docutils literal notranslate"><span class="pre">request.enable_buffering()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_body"><code class="docutils literal notranslate"><span class="pre">request.set_body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_header"><code class="docutils literal notranslate"><span class="pre">request.set_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_headers"><code class="docutils literal notranslate"><span class="pre">request.set_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_method"><code class="docutils literal notranslate"><span class="pre">request.set_method()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_path"><code class="docutils literal notranslate"><span class="pre">request.set_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_query"><code class="docutils literal notranslate"><span class="pre">request.set_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_raw_body"><code class="docutils literal notranslate"><span class="pre">request.set_raw_body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_raw_query"><code class="docutils literal notranslate"><span class="pre">request.set_raw_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.request.request.set_scheme"><code class="docutils literal notranslate"><span class="pre">request.set_scheme()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kong.service.html#module-kong.service.response">kong.service.response module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.service.html#kong.service.response.response"><code class="docutils literal notranslate"><span class="pre">response</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.response.response.get_body"><code class="docutils literal notranslate"><span class="pre">response.get_body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.response.response.get_header"><code class="docutils literal notranslate"><span class="pre">response.get_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.response.response.get_headers"><code class="docutils literal notranslate"><span class="pre">response.get_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.response.response.get_raw_body"><code class="docutils literal notranslate"><span class="pre">response.get_raw_body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.response.response.get_status"><code class="docutils literal notranslate"><span class="pre">response.get_status()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kong.service.html#module-kong.service">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kong.service.html#kong.service.service"><code class="docutils literal notranslate"><span class="pre">service</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.request"><code class="docutils literal notranslate"><span class="pre">service.request</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.response"><code class="docutils literal notranslate"><span class="pre">service.response</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.set_target"><code class="docutils literal notranslate"><span class="pre">service.set_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.set_tls_verify"><code class="docutils literal notranslate"><span class="pre">service.set_tls_verify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.set_tls_verify_depth"><code class="docutils literal notranslate"><span class="pre">service.set_tls_verify_depth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="kong.service.html#kong.service.service.set_upstream"><code class="docutils literal notranslate"><span class="pre">service.set_upstream()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-kong.cluster">
<span id="kong-cluster-module"></span><h2>kong.cluster module<a class="headerlink" href="#module-kong.cluster" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.cluster.cluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.cluster.</span></span><span class="sig-name descname"><span class="pre">cluster</span></span><a class="reference internal" href="_modules/kong/cluster.html#cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.cluster.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.cluster.cluster.get_id">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/kong/cluster.html#cluster.get_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.cluster.cluster.get_id" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the unique ID for this Kong cluster. If Kong
is running in DB-less mode without a cluster ID explicitly defined,
then this method returns <cite>nil</cite>.
For hybrid mode, all control planes and data planes belonging to the same
cluster return the same cluster ID. For traditional database-based
deployments, all Kong nodes pointing to the same database also return
the same cluster ID.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>id, err = kong.cluster.get_id()</p>
<p>if err:</p>
<blockquote>
<div><p># handle errorif not id:</p>
<p># no cluster ID is available# use id here</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The v4 UUID used by this cluster as its ID.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An error message.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.ip">
<span id="kong-ip-module"></span><h2>kong.ip module<a class="headerlink" href="#module-kong.ip" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.ip.ip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.ip.</span></span><span class="sig-name descname"><span class="pre">ip</span></span><a class="reference internal" href="_modules/kong/ip.html#ip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.ip.ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.ip.ip.is_trusted">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_trusted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/kong/ip.html#ip.is_trusted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.ip.ip.is_trusted" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Depending on the <cite>trusted_ips</cite> configuration property,
this function returns whether a given IP is trusted or not.
Both ipv4 and ipv6 are supported.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>if kong.ip.is_trusted(“1.1.1.1”):</p>
<blockquote>
<div><p>kong.log(“The IP is trusted”)</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>address</strong> (<em>str</em>) – A string representing an IP address.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> if the IP is trusted, <cite>false</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.log">
<span id="kong-log-module"></span><h2>kong.log module<a class="headerlink" href="#module-kong.log" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.log.log">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.log.</span></span><span class="sig-name descname"><span class="pre">log</span></span><a class="reference internal" href="_modules/kong/log.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.alert">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.alert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.alert" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id1"><span class="problematic" id="id2">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id3"><span class="problematic" id="id4">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id5"><span class="problematic" id="id6">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id7"><span class="problematic" id="id8">``</span></a><a href="#id9"><span class="problematic" id="id10">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.crit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">crit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.crit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.crit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id15"><span class="problematic" id="id16">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id17"><span class="problematic" id="id18">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id19"><span class="problematic" id="id20">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.debug">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.debug" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id29"><span class="problematic" id="id30">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id31"><span class="problematic" id="id32">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id33"><span class="problematic" id="id34">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id35"><span class="problematic" id="id36">``</span></a><a href="#id37"><span class="problematic" id="id38">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.deprecation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deprecation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.deprecation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.deprecation" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Arguments given to this function can be of any type, but table arguments
are converted to strings via <cite>tostring</cite> (thus potentially calling a
table’s <cite>__tostring</cite> metamethod if set). When the last argument is a table,
it is considered as a deprecation metadata. The table can include the
following properties:
<a href="#id43"><span class="problematic" id="id44">``</span></a>` lua
{</p>
<blockquote>
<div><p>after = “2.5.0”,   – deprecated after Kong version 2.5.0 (defaults to <cite>nil</cite>)
removal = “3.0.0”, – about to be removed with Kong version 3.0.0 (defaults to <cite>nil</cite>)
trace = true,      – writes stack trace along with the deprecation message (defaults to <cite>nil</cite>)</p>
</div></blockquote>
<p>For example, the following call:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">lua</span>
<span class="pre">kong.log.deprecation(&quot;hello</span> <span class="pre">&quot;,</span> <span class="pre">&quot;world&quot;)</span>
<span class="pre">`</span></code>
would, within the core, produce a log line similar to:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">hello</span> <span class="pre">world,</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code>
If invoked from within a plugin (for example, <cite>key-auth</cite>) it would include the
namespace prefix:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">[key-auth]</span> <span class="pre">hello</span> <span class="pre">world,</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code>
And with metatable, the following call:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">lua</span>
<span class="pre">kong.log.deprecation(&quot;hello</span> <span class="pre">&quot;,</span> <span class="pre">&quot;world&quot;,</span> <span class="pre">{</span> <span class="pre">after</span> <span class="pre">=</span> <span class="pre">&quot;2.5.0&quot;,</span> <span class="pre">removal</span> <span class="pre">=</span> <span class="pre">&quot;3.0.0&quot;</span> <span class="pre">})</span>
<span class="pre">`</span></code>
would, within the core, produce a log line similar to:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">hello</span> <span class="pre">world</span> <span class="pre">(deprecated</span> <span class="pre">after</span> <span class="pre">2.5.0,</span> <span class="pre">scheduled</span> <span class="pre">for</span> <span class="pre">removal</span> <span class="pre">in</span> <span class="pre">3.0.0),</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.deprecation(“hello “, “world”)</p>
<p>kong.log.deprecation(“hello “, “world”, { after = “2.5.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { removal = “3.0.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { after = “2.5.0”, removal = “3.0.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { trace = true })</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>all params will be concatenated and stringified before being sent to the log
(if the last param is a table, it is considered as a deprecation metadata)</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.err">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.err"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.err" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id49"><span class="problematic" id="id50">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id51"><span class="problematic" id="id52">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id53"><span class="problematic" id="id54">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id55"><span class="problematic" id="id56">``</span></a><a href="#id57"><span class="problematic" id="id58">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.info">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.info" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id63"><span class="problematic" id="id64">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id65"><span class="problematic" id="id66">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id67"><span class="problematic" id="id68">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id69"><span class="problematic" id="id70">``</span></a><a href="#id71"><span class="problematic" id="id72">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.notice">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">notice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.notice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.notice" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id77"><span class="problematic" id="id78">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id79"><span class="problematic" id="id80">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id81"><span class="problematic" id="id82">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id83"><span class="problematic" id="id84">``</span></a><a href="#id85"><span class="problematic" id="id86">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.serialize">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.serialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.serialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.set_serialize_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_serialize_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.set_serialize_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.set_serialize_value" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets a value to be used on the <cite>serialize</cite> custom table.
Logging plugins use the output of <cite>kong.log.serialize()</cite> as a base for their logs.
This function lets you customize the log output.
It can be used to replace existing values in the output, or to delete
existing values by passing <cite>nil</cite>.
<strong>Note:</strong> The type-checking of the <cite>value</cite> parameter can take some time, so
it is deferred to the <cite>serialize()</cite> call, which happens in the log
phase in most real-usage cases.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Adds a new value to the serialized table</p>
<p>kong.log.set_serialize_value(“my_new_value”, 1)</p>
<p>assert(kong.log.serialize().my_new_value == 1)</p>
<p># Value can be a table</p>
<p>kong.log.set_serialize_value(“my”, { new = { value = 2 } })</p>
<p>assert(kong.log.serialize().my.new.value == 2)</p>
<p># It is possible to change an existing serialized value</p>
<p>kong.log.set_serialize_value(“my_new_value”, 3)</p>
<p>assert(kong.log.serialize().my_new_value == 3)</p>
<p># Unset an existing value by setting it to nil</p>
<p>kong.log.set_serialize_value(“my_new_value”, nil)</p>
<p>assert(kong.log.serialize().my_new_value == nil)</p>
<p># Dots in the key are interpreted as table accesses</p>
<p>kong.log.set_serialize_value(“my.new.value”, 4)</p>
<p>assert(kong.log.serialize().my.new_value == 4)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The name of the field.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – Value to be set. When a table is used, its keys must be numbers, strings, or booleans, and its values can be numbers, strings, or other tables like itself, recursively.</p></li>
<li><p><strong>options</strong> (<em>table</em>) – Can contain two entries: options.mode can be <cite>set</cite> (the default, always sets), <cite>add</cite> (only add if entry does not already exist) and <cite>replace</cite> (only change value if it already exists).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The request information table.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.log.log.warn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/log.html#log.warn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.log.log.warn" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id91"><span class="problematic" id="id92">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id93"><span class="problematic" id="id94">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id95"><span class="problematic" id="id96">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id97"><span class="problematic" id="id98">``</span></a><a href="#id99"><span class="problematic" id="id100">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.node">
<span id="kong-node-module"></span><h2>kong.node module<a class="headerlink" href="#module-kong.node" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.node.node">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.node.</span></span><span class="sig-name descname"><span class="pre">node</span></span><a class="reference internal" href="_modules/kong/node.html#node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.node.node" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.node.node.get_hostname">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_hostname</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/node.html#node.get_hostname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.node.node.get_hostname" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the name used by the local machine.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>hostname = kong.node.get_hostname()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The local machine hostname.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.node.node.get_id">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/node.html#node.get_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.node.node.get_id" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the ID used by this node to describe itself.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>id = kong.node.get_id()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The v4 UUID used by this node as its ID.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.node.node.get_memory_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_memory_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/node.html#node.get_memory_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.node.node.get_memory_stats" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns memory usage statistics about this node.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>res = kong.node.get_memory_stats()</p>
<p># res will have the following structure:</p>
<p>{</p>
<p>lua_shared_dicts = {</p>
<p>kong = {</p>
<p>allocated_slabs = 12288,</p>
<p>capacity = 24576</p>
<p>},</p>
<p>kong_db_cache = {</p>
<p>allocated_slabs = 12288,</p>
<p>capacity = 12288</p>
<p>}</p>
<p>},</p>
<p>workers_lua_vms = {</p>
<p>{</p>
<p>http_allocated_gc = 1102,</p>
<p>pid = 18004</p>
<p>},</p>
<p>{</p>
<p>http_allocated_gc = 1102,</p>
<p>pid = 18005</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>res = kong.node.get_memory_stats(“k”, 1)</p>
<p># res will have the following structure:</p>
<p>{</p>
<p>lua_shared_dicts = {</p>
<p>kong = {</p>
<p>allocated_slabs = “12.0 KiB”,</p>
<p>capacity = “24.0 KiB”,</p>
<p>},</p>
<p>kong_db_cache = {</p>
<p>allocated_slabs = “12.0 KiB”,</p>
<p>capacity = “12.0 KiB”,</p>
<p>}</p>
<p>},</p>
<p>workers_lua_vms = {</p>
<p>{</p>
<p>http_allocated_gc = “1.1 KiB”,</p>
<p>pid = 18004</p>
<p>},</p>
<p>{</p>
<p>http_allocated_gc = “1.1 KiB”,</p>
<p>pid = 18005</p>
<p>}</p>
<p>}</p>
<p>}</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit</strong> (<em>str</em>) – The unit that memory is reported in. Can be
any of <cite>b/B</cite>, <cite>k/K</cite>, <cite>m/M</cite>, or <cite>g/G</cite> for bytes, kibibytes, mebibytes,
or gibibytes, respectively. Defaults to <cite>b</cite> (bytes).</p></li>
<li><p><strong>scale</strong> (<em>number</em>) – The number of digits to the right of the decimal
point. Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table containing memory usage statistics for this node.
If <cite>unit</cite> is <cite>b/B</cite> (the default), reported values are Lua numbers.
Otherwise, reported values are strings with the unit as a suffix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.request">
<span id="kong-request-module"></span><h2>kong.request module<a class="headerlink" href="#module-kong.request" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.request.request">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.request.</span></span><span class="sig-name descname"><span class="pre">request</span></span><a class="reference internal" href="_modules/kong/request.html#request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mimetype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the request data as a key/value table.
A high-level convenience function.
The body is parsed with the most appropriate format:
* If <cite>mimetype</cite> is specified, it decodes the body with the requested</p>
<blockquote>
<div><p>content type (if supported). This takes precedence over any content type
present in the request.
The optional argument <cite>mimetype</cite> can be one of the following strings:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>application/x-www-form-urlencoded</cite></p></li>
<li><p><cite>application/json</cite></p></li>
<li><p><cite>multipart/form-data</cite></p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Whether <cite>mimetype</cite> is specified or a request content type is otherwise
present in the request, each content type behaves as follows:
* If the request content type is <cite>application/x-www-form-urlencoded</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Returns the body as form-encoded.</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>If the request content type is <cite>multipart/form-data</cite>:
* Decodes the body as multipart form data</p>
<blockquote>
<div><p>(same as <cite>multipart(kong.request.get_raw_body(),
kong.request.get_header(“Content-Type”)):get_all()</cite> ).</p>
</div></blockquote>
</li>
<li><p>If the request content type is <cite>application/json</cite>:
* Decodes the body as JSON</p>
<blockquote>
<div><p>(same as <cite>json.decode(kong.request.get_raw_body())</cite>).</p>
</div></blockquote>
<ul class="simple">
<li><p>JSON types are converted to matching Lua types.</p></li>
</ul>
</li>
<li><p>If the request contains none of the above and the <cite>mimetype</cite> argument is
not set, returns <cite>nil</cite> and an error message indicating the
body could not be parsed.</p></li>
</ul>
<p>The optional argument <cite>max_args</cite> can be used to set a limit on the number
of form arguments parsed for <cite>application/x-www-form-urlencoded</cite> payloads.
The third return value is string containing the mimetype used to parsed
the body (as per the <cite>mimetype</cite> argument), allowing the caller to identify
what MIME type the body was parsed as.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>body, err, mimetype = kong.request.get_body()</p>
<p>body.name # “John Doe”</p>
<p>body.age  # “42”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mimetype</strong> (<em>str</em>) – The MIME type.</p></li>
<li><p><strong>max_args</strong> (<em>number</em>) – Sets a limit on the maximum number of parsed
arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table representation of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An error message.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mimetype The MIME type used.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_forwarded_host">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_host</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_forwarded_host"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_forwarded_host" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the host component of the request’s URL or the value of the “host”
header. Unlike <cite>kong.request.get_host()</cite>, this function also considers
<cite>X-Forwarded-Host</cite> if it comes from a trusted source. The returned value
is normalized to lowercase.
Whether this function considers <cite>X-Forwarded-Host</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_host() # “example.com”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded host.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_forwarded_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_forwarded_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_forwarded_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path component of the request’s URL, but also considers
<cite>X-Forwarded-Path</cite> if it comes from a trusted source. The value
is returned as a Lua string.
Whether this function considers <cite>X-Forwarded-Path</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not do any normalization on the request path.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_path() # /path</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded path.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_forwarded_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_forwarded_port"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_forwarded_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the port component of the request’s URL, but also considers
<cite>X-Forwarded-Host</cite> if it comes from a trusted source. The value
is returned as a Lua number.
Whether this function considers <cite>X-Forwarded-Proto</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.
When running Kong behind the L4 port mapping (or forwarding), you can also
configure:
* [port_maps](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#port_maps">https://docs.konghq.com/gateway/latest/reference/configuration/#port_maps</a>)
The <cite>port_maps</cite> configuration parameter enables this function to return the
port to which the port Kong is listening to is mapped to (in case they differ).</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_port() # 1234</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded port.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_forwarded_prefix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_prefix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_forwarded_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_forwarded_prefix" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the prefix path component of the request’s URL that Kong stripped
before proxying to upstream. It also checks if <cite>X-Forwarded-Prefix</cite> comes
from a trusted source, and uses it as-is when given. The value is returned
as a Lua string.
If a trusted <cite>X-Forwarded-Prefix</cite> is not passed, this function must be
called after Kong has run its router (<cite>access</cite> phase),
as the Kong router may strip the prefix of the request path. That stripped
path becomes the return value of this function, unless there is already
a trusted <cite>X-Forwarded-Prefix</cite> header in the request.
Whether this function considers <cite>X-Forwarded-Prefix</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not do any normalization on the request path prefix.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_prefix() # /prefix</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded path prefix or <cite>nil</cite> if the prefix was
not stripped.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_forwarded_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_forwarded_scheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_forwarded_scheme" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the scheme component of the request’s URL, but also considers
<cite>X-Forwarded-Proto</cite> if it comes from a trusted source. The returned
value is normalized to lowercase.
Whether this function considers <cite>X-Forwarded-Proto</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_scheme() # “https”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded scheme.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified request header.
The returned value is either a <cite>string</cite>, or can be <cite>nil</cite> if a header with
<cite>name</cite> was not found in the request. If a header with the same name is
present multiple times in the request, this function returns the value
of the first occurrence of this header.
Header names in are case-insensitive and are normalized to lowercase, and
dashes (<cite>-</cite>) can be written as underscores (<cite>_</cite>); that is, the header
<cite>X-Custom-Header</cite> can also be retrieved as <cite>x_custom_header</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request with the following headers:</p>
<p># Host: foo.com</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>kong.request.get_header(“Host”)            # “foo.com”</p>
<p>kong.request.get_header(“x-custom-header”) # “bla”</p>
<p>kong.request.get_header(“X-Another”)       # “foo bar”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the name of the header to be returned</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the header or nil if not present</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_headers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a Lua table holding the request headers. Keys are header names.
Values are either a string with the header value, or an array of strings
if a header was sent multiple times. Header names in this table are
case-insensitive and are normalized to lowercase, and dashes (<cite>-</cite>) can be
written as underscores (<cite>_</cite>); that is, the header <cite>X-Custom-Header</cite> can
also be retrieved as <cite>x_custom_header</cite>.
By default, this function returns up to <strong>100</strong> headers. The optional
<cite>max_headers</cite> argument can be specified to customize this limit, but must
be greater than <strong>1</strong> and not greater than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request with the following headers:</p>
<p># Host: foo.com</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>headers = kong.request.get_headers()</p>
<p>headers.host            # “foo.com”</p>
<p>headers.x_custom_header # “bla”</p>
<p>headers.x_another[1]    # “foo bar”</p>
<p>headers[“X-Another”][2] # “baz”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_headers</strong> (<em>number</em>) – Sets a limit on the maximum number of
parsed headers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The request headers in table form.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_host">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_host</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_host"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_host" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the host component of the request’s URL, or the value of the
“Host” header. The returned value is normalized to lowercase form.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_host() # “example.com”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The hostname.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_http_version">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_http_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_http_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_http_version" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP version used by the client in the request as a Lua
number, returning values such as <cite>1</cite>, <cite>1.1</cite>, <cite>2.0</cite>, or <cite>nil</cite> for
unrecognized values.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_http_version() # 1.1</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The HTTP version as a Lua number.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_method">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_method" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP method of the request. The value is normalized to
uppercase.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_method() # “GET”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The request method.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the normalized path component of the request’s URL. The return
value is the same as <cite>kong.request.get_raw_path()</cite> but normalized according
to RFC 3986 section 6:
* Percent-encoded values of unreserved characters are decoded (<cite>%20</cite></p>
<blockquote>
<div><p>becomes ` <a href="#id105"><span class="problematic" id="id106">`</span></a>).</p>
</div></blockquote>
<ul class="simple">
<li><p>Percent-encoded values of reserved characters have their hexidecimal
value uppercased (<cite>%2f</cite> becomes <cite>%2F</cite>).</p></li>
<li><p>Relative path elements (<cite>/.</cite> and <cite>/..</cite>) are dereferenced.</p></li>
<li><p>Duplicate slashes are consolidated (<cite>//</cite> becomes <cite>/</cite>).</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./">https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./</a></p>
<p>kong.request.get_path() # “/t/Abc 123ø%2F/test/”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the path</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_path_with_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_path_with_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_path_with_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_path_with_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path, including the query string if any. No
transformations or normalizations are done.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies?movie=foo">https://example.com:1234/v1/movies?movie=foo</a></p>
<p>kong.request.get_path_with_query() # “/v1/movies?movie=foo”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The path with the query string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_port"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the port component of the request’s URL. The value is returned
as a Lua number.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_port() # 1234</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The port.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the table of query arguments obtained from the query string. Keys
are query argument names. Values are either a string with the argument
value, a boolean <cite>true</cite> if an argument was not given a value, or an array
if an argument was given in the query string multiple times. Keys and
values are unescaped according to URL-encoded escaping rules.
Note that a query string <cite>?foo&amp;bar</cite> translates to two boolean <cite>true</cite>
arguments, and <cite>?foo=&amp;bar=</cite> translates to two string arguments containing
empty strings.
By default, this function returns up to <strong>100</strong> arguments. The optional
<cite>max_args</cite> argument can be specified to customize this limit, but must be
greater than <strong>1</strong> and not greater than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request GET /test?foo=hello%20world&amp;bar=baz&amp;zzz&amp;blo=&amp;bar=bla&amp;bar</p>
<p>for k, v in pairs(kong.request.get_query()) do</p>
<p>kong.log.inspect(k, v)# Will print</p>
<p># “foo” “hello world”</p>
<p># “bar” {“baz”, “bla”, true}</p>
<p># “zzz” true</p>
<p># “blo” “”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_args</strong> (<em>number</em>) – Sets a limit on the maximum number of parsed
arguments.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table representation of the query string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_query_arg">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_query_arg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_query_arg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_query_arg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified argument, obtained from the query
arguments of the current request.
The returned value is either a <cite>string</cite>, a boolean <cite>true</cite> if an
argument was not given a value, or <cite>nil</cite> if no argument with <cite>name</cite> was
found.
If an argument with the same name is present multiple times in the
query string, this function returns the value of the first occurrence.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request GET /test?foo=hello%20world&amp;bar=baz&amp;zzz&amp;blo=&amp;bar=bla&amp;bar</p>
<p>kong.request.get_query_arg(“foo”) # “hello world”</p>
<p>kong.request.get_query_arg(“bar”) # “baz”</p>
<p>kong.request.get_query_arg(“zzz”) # true</p>
<p>kong.request.get_query_arg(“blo”) # “”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value of the argument.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_raw_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_body</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_raw_body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_raw_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the plain request body.
If the body has no size (empty), this function returns an empty string.
If the size of the body is greater than the Nginx buffer size (set by
<cite>client_body_buffer_size</cite>), this function fails and returns an error
message explaining this limitation.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a body with payload “Hello, Earth!”:</p>
<p>kong.request.get_raw_body():gsub(“Earth”, “Mars”) # “Hello, Mars!”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The plain request body.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_raw_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_raw_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_raw_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path component of the request’s URL. It is not normalized in
any way and does not include the query string.
<strong>NOTE:</strong> Using the raw path to perform string comparision during request
handling (such as in routing, ACL/authorization checks, setting rate-limit
keys, etc) is widely regarded as insecure, as it can leave plugin code
vulnerable to path traversal attacks. Prefer <cite>kong.request.get_path()</cite> for
such use cases.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./?movie=foo">https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./?movie=foo</a></p>
<p>kong.request.get_raw_path() # “/t/Abc%20123%C3%B8%2f/parent/..//test/./”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The path.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_raw_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_raw_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_raw_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the query component of the request’s URL. It is not normalized in
any way (not even URL-decoding of special characters) and does not
include the leading <cite>?</cite> character.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/foo?msg=hello%20world&amp;bla=&amp;bar">https://example.com/foo?msg=hello%20world&amp;bla=&amp;bar</a></p>
<p>kong.request.get_raw_query() # “msg=hello%20world&amp;bla=&amp;bar”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The query component of the request’s URL.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_scheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_scheme" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the scheme component of the request’s URL. The returned value is
normalized to lowercase form.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_scheme() # “https”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string like <cite>“http”</cite> or <cite>“https”</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_start_time">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_start_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_start_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_start_time" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the request start time, in Unix epoch milliseconds.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_start_time() # 1649960273000</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The timestamp</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.request.request.get_uri_captures">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_uri_captures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/request.html#request.get_uri_captures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.request.request.get_uri_captures" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the URI captures matched by the router.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>captures = kong.request.get_uri_captures()</p>
<p>for idx, value in ipairs(captures.unnamed) do</p>
<p># do what you want to capturesfor name, value in pairs(captures.named) do</p>
<p># do what you want to captures</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tables containing unamed and named captures.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.response">
<span id="kong-response-module"></span><h2>kong.response module<a class="headerlink" href="#module-kong.response" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.response.response">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.response.</span></span><span class="sig-name descname"><span class="pre">response</span></span><a class="reference internal" href="_modules/kong/response.html#response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.add_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.add_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.add_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Adds a response header with the given value. Unlike
<cite>kong.response.set_header()</cite>, this function does not remove any existing
header with the same name. Instead, another header with the same name is
added to the response. If no header with this name already exists on
the response, then it is added with the given value, similarly to
<cite>kong.response.set_header().</cite></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.add_header(“Cache-Control”, “no-cache”)</p>
<p>kong.response.add_header(“Cache-Control”, “no-store”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The header name.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The header value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.clear_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.clear_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.clear_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Removes all occurrences of the specified header in the response sent to
the client.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_header(“X-Foo”, “foo”)</p>
<p>kong.response.add_header(“X-Foo”, “bar”)</p>
<p>kong.response.clear_header(“X-Foo”)</p>
<p># from here onwards, no X-Foo headers will exist in the response</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the header to be cleared</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.error">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.error" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function interrupts the current processing and produces an error
response.
It is recommended to use this function in conjunction with the <cite>return</cite>
operator, to better reflect its meaning:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">return</span> <span class="pre">kong.response.error(500,</span> <span class="pre">&quot;Error&quot;,</span> <span class="pre">{[&quot;Content-Type&quot;]</span> <span class="pre">=</span> <span class="pre">&quot;text/html&quot;})</span>
<span class="pre">`</span></code>
1. The <cite>status</cite> argument sets the status code of the response that
is seen by the client. The status code must an error code, that is,
greater than 399.
2. The optional <cite>message</cite> argument sets the message describing
the error, which is written in the body.
3. The optional <cite>headers</cite> argument can be a table specifying response
headers to send. If specified, its behavior is similar to
<cite>kong.response.set_headers()</cite>.</p>
<blockquote>
<div><p>This method sends the response formatted in JSON, XML, HTML or plaintext.
The actual format is determined using one of the following options, in
this order:
- Manually specified in the <cite>headers</cite> argument using the <cite>Content-Type</cite>
header.
- Conforming to the <cite>Accept</cite> header from the request.
- If there is no setting in the <cite>Content-Type</cite> or <cite>Accept</cite> header, the
response defaults to JSON format. Also see the <cite>Content-Length</cite>
header in the produced response for convenience.</p>
</div></blockquote>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, admin_api, header_filter, only, if, body, is, nil</p>
</dd>
<dt>Example:</dt><dd><p>return kong.response.error(403, “Access Forbidden”, {</p>
<p>[“Content-Type”] = “text/plain”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.error(403, “Access Forbidden”)</p>
<p># -</p>
<p>return kong.response.error(403)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>number</em>) – The status to be used (&gt;399).</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The error message to be used.</p></li>
<li><p><strong>headers</strong> (<em>table</em>) – The headers to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.exit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.exit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.exit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function interrupts the current processing and produces a response.
It is typical to see plugins using it to produce a response before Kong
has a chance to proxy the request (e.g. an authentication plugin rejecting
a request, or a caching plugin serving a cached response).
It is recommended to use this function in conjunction with the <cite>return</cite>
operator, to better reflect its meaning:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">return</span> <span class="pre">kong.response.exit(200,</span> <span class="pre">&quot;Success&quot;)</span>
<span class="pre">`</span></code>
Calling <cite>kong.response.exit()</cite> interrupts the execution flow of
plugins in the current phase. Subsequent phases will still be invoked.
For example, if a plugin calls <cite>kong.response.exit()</cite> in the <cite>access</cite>
phase, no other plugin is executed in that phase, but the
<cite>header_filter</cite>, <cite>body_filter</cite>, and <cite>log</cite> phases are still executed,
along with their plugins. Plugins should be programmed defensively
against cases when a request is <strong>not</strong> proxied to the Service, but
instead is produced by Kong itself.
1. The first argument <cite>status</cite> sets the status code of the response that
is seen by the client.</p>
<blockquote>
<div><p>In L4 proxy mode, the <cite>status</cite> code provided is primarily for logging
and statistical purposes, and is not visible to the client directly.
In this mode, only the following status codes are supported:
* 200 - OK
* 400 - Bad request
* 403 - Forbidden
* 500 - Internal server error
* 502 - Bad gateway
* 503 - Service unavailable</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>The second, optional, <cite>body</cite> argument sets the response body. If it is
a string, no special processing is done, and the body is sent
as-is.  It is the caller’s responsibility to set the appropriate
<cite>Content-Type</cite> header via the third argument.
As a convenience, <cite>body</cite> can be specified as a table. In that case,
the <cite>body</cite> is JSON-encoded and has the <cite>application/json</cite> Content-Type
header set.
On gRPC, we cannot send the <cite>body</cite> with this function, so
it sends <cite>“body”</cite> in the <cite>grpc-message</cite> header instead.
* If the body is a table, it looks for the <cite>message</cite> field in the body,
and uses that as a <cite>grpc-message</cite> header.
* If you specify <cite>application/grpc</cite> in the <cite>Content-Type</cite> header, the
body is sent without needing the <cite>grpc-message</cite> header.
In L4 proxy mode, <cite>body</cite> can only be <cite>nil</cite> or a string. Automatic JSON
encoding is not available. When <cite>body</cite> is provided, depending on the
value of <cite>status</cite>, the following happens:
* When <cite>status</cite> is 500, 502 or 503, then <cite>body</cite> is logged in the Kong
error log file.
* When the <cite>status</cite> is anything else, <cite>body</cite> is sent back to the L4 client.</p></li>
<li><p>The third, optional, <cite>headers</cite> argument can be a table specifying
response headers to send. If specified, its behavior is similar to
<cite>kong.response.set_headers()</cite>. This argument is ignored in L4 proxy mode.</p></li>
</ol>
<p>Unless manually specified, this method automatically sets the
<cite>Content-Length</cite> header in the produced response for convenience.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>preread, rewrite, access, admin_api, header_filter, only, if, body, is, nil</p>
</dd>
<dt>Example:</dt><dd><p>return kong.response.exit(403, “Access Forbidden”, {</p>
<p>[“Content-Type”] = “text/plain”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.exit(403, [[{“message”:”Access Forbidden”}]], {</p>
<p>[“Content-Type”] = “application/json”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.exit(403, { message = “Access Forbidden” }, {</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p># In L4 proxy mode</p>
<p>return kong.response.exit(200, “Success”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>number</em>) – The status to be used.</p></li>
<li><p><strong>body</strong> (<em>bytes</em>) – The body to be used.</p></li>
<li><p><strong>headers</strong> (<em>table</em>) – The headers to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.get_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.get_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.get_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified response header, as would be seen by
the client once received.
The list of headers returned by this function can consist of both response
headers from the proxied Service _and_ headers added by Kong (e.g. via
<cite>kong.response.add_header()</cite>).
The return value is either a <cite>string</cite>, or can be <cite>nil</cite> if a header with
<cite>name</cite> is not found in the response. If a header with the same name is
present multiple times in the request, this function returns the value
of the first occurrence of this header.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a response with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>kong.response.get_header(“x-custom-header”) # “bla”</p>
<p>kong.response.get_header(“X-Another”)       # “foo bar”</p>
<p>kong.response.get_header(“X-None”)          # nil</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the header.
Header names are case-insensitive and dashes (<cite>-</cite>) can be written as
underscores (<cite>_</cite>). For example, the header <cite>X-Custom-Header</cite> can also be
retrieved as <cite>x_custom_header</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the header.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.get_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/kong/response.html#response.get_headers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.get_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a Lua table holding the response headers. Keys are header names.
Values are either a string with the header value, or an array of strings
if a header was sent multiple times. Header names in this table are
case-insensitive and are normalized to lowercase, and dashes (<cite>-</cite>) can be
written as underscores (<cite>_</cite>). For example, the header <cite>X-Custom-Header</cite> can
also be retrieved as <cite>x_custom_header</cite>.
A response initially has no headers. Headers are added when a plugin
short-circuits the proxying by producing a header
(e.g. an authentication plugin rejecting a request), or if the request has
been proxied, and one of the latter execution phases is currently running.
Unlike <cite>kong.service.response.get_headers()</cite>, this function returns <em>all</em>
headers as the client would see them upon reception, including headers
added by Kong itself.
By default, this function returns up to <strong>100</strong> headers. The optional
<cite>max_headers</cite> argument can be specified to customize this limit, but must
be greater than <strong>1</strong> and equal to or less than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given an response from the Service with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>headers = kong.response.get_headers()</p>
<p>headers.x_custom_header # “bla”</p>
<p>headers.x_another[1]    # “foo bar”</p>
<p>headers[“X-Another”][2] # “baz”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_headers</strong> (<em>number</em>) – Limits the number of headers parsed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>headers A table representation of the headers in the
response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>err If more headers than <cite>max_headers</cite> were present,
returns a string with the error <cite>“truncated”</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.get_source">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_source</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.get_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.get_source" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function helps determine where the current response originated
from. Since Kong is a reverse proxy, it can short-circuit a request and
produce a response of its own, or the response can come from the proxied
Service.
Returns a string with three possible values:
* <cite>“exit”</cite> is returned when, at some point during the processing of the</p>
<blockquote>
<div><p>request, there has been a call to <cite>kong.response.exit()</cite>. This happens
when the request was short-circuited by a plugin or by Kong
itself (e.g. invalid credentials).</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>“error”</cite> is returned when an error has happened while processing the
request. For example, a timeout while connecting to the upstream
service.</p></li>
<li><p><cite>“service”</cite> is returned when the response was originated by successfully
contacting the proxied Service.</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>if kong.response.get_source() == “service”:</p>
<blockquote>
<div><p>kong.log(“The response comes from the Service”)</p>
</div></blockquote>
<p>elseif kong.response.get_source() == “error”:</p>
<blockquote>
<div><p>kong.log(“There was an error while processing the request”)</p>
</div></blockquote>
<p>elseif kong.response.get_source() == “exit”:</p>
<blockquote>
<div><p>kong.log(“There was an early exit while processing the request”)</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The source.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.get_status">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.get_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.get_status" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP status code currently set for the downstream response (as
a Lua number).
If the request was proxied (as per <cite>kong.response.get_source()</cite>), the
return value is the response from the Service (identical to
<cite>kong.service.response.get_status()</cite>).
If the request was _not_ proxied and the response was produced by Kong
itself (i.e. via <cite>kong.response.exit()</cite>), the return value is
returned as-is.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.get_status() # 200</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>status The HTTP status code currently set for the
downstream response.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.set_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.set_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.set_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets a response header with the given value. This function overrides any
existing header with the same name.
Note: Underscores in header names are automatically transformed into dashes
by default. If you want to deactivate this behavior, set the
<cite>lua_transform_underscores_in_response_headers</cite> Nginx config option to <cite>off</cite>.
This setting can be set in the Kong Config file:</p>
<blockquote>
<div><p>nginx_http_lua_transform_underscores_in_response_headers = off</p>
</div></blockquote>
<p>Be aware that changing this setting might break any plugins that
rely on the automatic underscore conversion.
You cannot set Transfer-Encoding header with this function. It will be ignored.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_header(“X-Foo”, “value”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the header</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The new value for the header.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.set_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.set_headers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.set_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the headers for the response. Unlike <cite>kong.response.set_header()</cite>,
the <cite>headers</cite> argument must be a table in which each key is a string
corresponding to a header’s name, and each value is a string, or an
array of strings.
The resulting headers are produced in lexicographical order. The order of
entries with the same name (when values are given as an array) is
retained.
This function overrides any existing header bearing the same name as those
specified in the <cite>headers</cite> argument. Other headers remain unchanged.
You cannot set Transfer-Encoding header with this function. It will be ignored.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_headers({</p>
<p>[“Bla”] = “boo”,</p>
<p>[“X-Foo”] = “foo3”,</p>
<p>[“Cache-Control”] = { “no-store”, “no-cache” }</p>
<p>})</p>
<p># Will add the following headers to the response, in this order:</p>
<p># X-Bar: bar1</p>
<p># Bla: boo</p>
<p># Cache-Control: no-store</p>
<p># Cache-Control: no-cache</p>
<p># X-Foo: foo3</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>headers</strong> (<em>table</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.response.response.set_status">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/kong/response.html#response.set_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.response.response.set_status" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Allows changing the downstream response HTTP status code before sending it
to the client.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_status(404)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>status</strong> (<em>number</em>) – The new status.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.router">
<span id="kong-router-module"></span><h2>kong.router module<a class="headerlink" href="#module-kong.router" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.router.router">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.router.</span></span><span class="sig-name descname"><span class="pre">router</span></span><a class="reference internal" href="_modules/kong/router.html#router"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.router.router" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.router.router.get_route">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_route</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/router.html#router.get_route"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.router.router.get_route" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the current <cite>route</cite> entity. The request is matched against this
route.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>route = kong.router.get_route()</p>
<p>protocols = route.protocols</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <cite>route</cite> entity.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.router.router.get_service">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_service</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="reference internal" href="_modules/kong/router.html#router.get_service"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.router.router.get_service" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the current <cite>service</cite> entity. The request is targeted to this
upstream service.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>if kong.router.get_service():</p>
<blockquote>
<div><p># routed by route &amp; service entities</p>
</div></blockquote>
<p>else:</p>
<blockquote>
<div><p># routed by a route without a service</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <cite>service</cite> entity.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong.vault">
<span id="kong-vault-module"></span><h2>kong.vault module<a class="headerlink" href="#module-kong.vault" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.vault.vault">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.vault.</span></span><span class="sig-name descname"><span class="pre">vault</span></span><a class="reference internal" href="_modules/kong/vault.html#vault"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.vault.vault" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.vault.vault.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/kong/vault.html#vault.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.vault.vault.get" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Resolves the passed in reference and returns the value of it.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>value, err = kong.vault.get(“{vault://env/cert/key}”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to resolve</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>resolved value of the reference</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>error message on failure, otherwise <cite>nil</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.vault.vault.is_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/kong/vault.html#vault.is_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.vault.vault.is_reference" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Checks if the passed in reference looks like a reference.
Valid references start with ‘{vault://’ and end with ‘}’.
If you need more thorough validation,
use <cite>kong.vault.parse_reference</cite>.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>kong.vault.is_reference(“{vault://env/key}”) # true</p>
<p>kong.vault.is_reference(“not a reference”)   # false</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to check</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> is the passed in reference looks like a reference, otherwise <cite>false</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.vault.vault.parse_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/kong/vault.html#vault.parse_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.vault.vault.parse_reference" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Parses and decodes the passed in reference and returns a table
containing its components.
Given a following resource:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">&quot;{vault://env/cert/key?prefix=SSL_#1}&quot;</span>
<span class="pre">`</span></code>
This function will return following table:
<a href="#id107"><span class="problematic" id="id108">``</span></a><a href="#id109"><span class="problematic" id="id110">`</span></a>lua
{</p>
<blockquote>
<div><p>name     = “env”,  – name of the Vault entity or Vault strategy
resource = “cert”, – resource where secret is stored
key      = “key”,  – key to lookup if the resource is secret object
config   = {       – if there are any config options specified</p>
<blockquote>
<div><p>prefix = “<a href="#id221"><span class="problematic" id="id222">SSL_</span></a>”</p>
</div></blockquote>
<p>},
version  = 1       – if the version is specified</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>ref, err = kong.vault.parse_reference(“{vault://env/cert/key?prefix=SSL_#1}”) # table</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to parse</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a table containing each component of the reference, or <cite>nil</cite> on error</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>error message on failure, otherwise <cite>nil</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-kong">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-kong" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kong.kong">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kong.</span></span><span class="sig-name descname"><span class="pre">kong</span></span><a class="reference internal" href="_modules/kong.html#kong"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kong.kong" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.client">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">client</span></span><a class="headerlink" href="#kong.kong.client" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.authenticate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">credential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.client.authenticate" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the authenticated consumer and/or credential for the current request.
While both <cite>consumer</cite> and <cite>credential</cite> can be <cite>nil</cite>,
at least one of them must exist. Otherwise, this function will throw an
error.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access</p>
</dd>
<dt>Example:</dt><dd><p># assuming <cite>credential</cite> and <cite>consumer</cite> have been set by some authentication code</p>
<p>kong.client.authenticate(consumer, credentials)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>consumer</strong> (<em>table</em>) – The consumer to set. If no
value is provided, then any existing value will be cleared.</p></li>
<li><p><strong>credential</strong> (<em>table</em>) – The credential to set. If
no value is provided, then any existing value will be cleared.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_consumer">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_consumer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.client.get_consumer" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the <cite>consumer</cite> entity of the currently authenticated consumer.
If not set yet, it returns <cite>nil</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>consumer = kong.client.get_consumer()</p>
<p>if consumer:</p>
<blockquote>
<div><p>consumer_id = consumer.id</p>
</div></blockquote>
<p>else:</p>
<blockquote>
<div><p># request not authenticated yet, or a credential</p>
</div></blockquote>
<p># without a consumer (external auth)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The authenticated consumer entity.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_credential">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_credential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.client.get_credential" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the credentials of the currently authenticated consumer.
If not set yet, it returns <cite>nil</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>credential = kong.client.get_credential()</p>
<p>if credential:</p>
<blockquote>
<div><p>consumer_id = credential.consumer_id</p>
</div></blockquote>
<p>else:</p>
<blockquote>
<div><p># request not authenticated yet</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The authenticated credential.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_forwarded_ip">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_ip</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.client.get_forwarded_ip" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the remote address of the client making the request. Unlike
<cite>kong.client.get_ip</cite>, this function will consider forwarded addresses in
cases when a load balancer is in front of Kong. Whether this function
returns a forwarded address or not depends on several Kong configuration
parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Given a client with IP 127.0.0.1 making connection through</p>
<p># a load balancer with IP 10.0.0.1 to Kong answering the request for</p>
<p># <a class="reference external" href="https://username:password&#64;example.com:1234/v1/movies">https://username:password&#64;example.com:1234/v1/movies</a></p>
<p>kong.client.get_forwarded_ip() # “127.0.0.1”</p>
<p># Note: This example assumes that 10.0.0.1 is one of the trusted IPs, and that</p>
<p># the load balancer adds the right headers matching with the configuration</p>
<p># of <cite>real_ip_header</cite>, e.g. <cite>proxy_protocol</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The remote IP address of the client making the request,
considering forwarded addresses.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_forwarded_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.client.get_forwarded_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the remote port of the client making the request. Unlike
<cite>kong.client.get_port</cite>, this function will consider forwarded ports in cases
when a load balancer is in front of Kong. Whether this function returns a
forwarded port or not depends on several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># [client]:40000 &lt;-&gt; 80:[balancer]:30000 &lt;-&gt; 80:[kong]:20000 &lt;-&gt; 80:[service]</p>
<p>kong.client.get_forwarded_port() # 40000</p>
<p># Note: This example assumes that [balancer] is one of the trusted IPs, and that</p>
<p># the load balancer adds the right headers matching with the configuration</p>
<p># of <cite>real_ip_header</cite>, e.g. <cite>proxy_protocol</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The remote client port, considering forwarded ports.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_ip">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_ip</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.client.get_ip" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the remote address of the client making the request. This module
<strong>always</strong> returns the address of the client directly connecting to Kong.
That is, in cases when a load balancer is in front of Kong, this function
returns the load balancer’s address, and <strong>not</strong> that of the
downstream client.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Given a client with IP 127.0.0.1 making connection through</p>
<p># a load balancer with IP 10.0.0.1 to Kong answering the request for</p>
<p># <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.client.get_ip() # “10.0.0.1”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The remote IP address of the client making the request.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.client.get_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the remote port of the client making the request. This
<strong>always</strong> returns the port of the client directly connecting to Kong. That
is, in cases when a load balancer is in front of Kong, this function
returns the load balancer’s port, and <strong>not</strong> that of the downstream client.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># [client]:40000 &lt;-&gt; 80:[balancer]:30000 &lt;-&gt; 80:[kong]:20000 &lt;-&gt; 80:[service]</p>
<p>kong.client.get_port() # 30000</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The remote client port.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.get_protocol">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_protocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_terminated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.client.get_protocol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the protocol matched by the current route (<cite>“http”</cite>, <cite>“https”</cite>, <cite>“tcp”</cite> or
<cite>“tls”</cite>), or <cite>nil</cite>, if no route has been matched, which can happen when dealing with
erroneous requests.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.client.get_protocol() # “http”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>allow_terminated</strong> (<em>bool</em>) – If set, the <cite>X-Forwarded-Proto</cite> header is checked when checking for HTTPS.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Can be one of <cite>“http”</cite>, <cite>“https”</cite>, <cite>“tcp”</cite>, <cite>“tls”</cite> or <cite>nil</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>nil</cite> if successful, or an error message if it fails.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>err</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.load_consumer">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_consumer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumer_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_by_username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.client.load_consumer" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the consumer from the datastore.
Looks up the consumer by ID, and can optionally do a second search by name.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>consumer_id = “john_doe”</p>
<p>consumer = kong.client.load_consumer(consumer_id, true)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>consumer_id</strong> (<em>str</em>) – The consumer ID to look up.</p></li>
<li><p><strong>search_by_username</strong> (<em>bool</em>) – If truthy,
and if the consumer is not found by ID,
then a second search by username will be performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Consumer entity or <cite>nil</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>nil</cite> if successful, or an error message if it fails.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>err</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.client.tls">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tls</span></span><a class="headerlink" href="#kong.kong.client.tls" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.tls.disable_session_reuse">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">disable_session_reuse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.client.tls.disable_session_reuse" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Prevents the TLS session for the current connection from being reused
by disabling the session ticket and session ID for the current TLS connection.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate</p>
</dd>
<dt>Example:</dt><dd><p>res, err = kong.client.tls.disable_session_reuse()</p>
<p>if not res:</p>
<blockquote>
<div><p># do something with err</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns <cite>true</cite> if successful, <cite>nil</cite> if it fails.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns <cite>nil</cite> if successful, or an error message if it fails.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>err</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.tls.get_full_client_certificate_chain">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_full_client_certificate_chain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.client.tls.get_full_client_certificate_chain" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the PEM encoded downstream client certificate chain with the
client certificate at the top and intermediate certificates
(if any) at the bottom.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, balancer, header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>cert, err = kong.client.get_full_client_certificate_chain()</p>
<p>if err:</p>
<blockquote>
<div><p># do something with errif not cert:</p>
<p># client did not complete mTLS# do something with cert</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns a PEM-encoded client certificate if the mTLS
handshake was completed, or <cite>nil</cite> if an error occurred or the client did
not present its certificate.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns <cite>nil</cite> if successful, or an error message if it fails.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>err</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.tls.request_client_certificate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">request_client_certificate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ca_certs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.client.tls.request_client_certificate" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Requests the client to present its client-side certificate to initiate mutual
TLS authentication between server and client.
This function <em>requests</em>, but does not <em>require</em> the client to start
the mTLS process. The TLS handshake can still complete even if the client
doesn’t present a client certificate. However, in that case, it becomes a
TLS connection instead of an mTLS connection, as there is no mutual
authentication.
To find out whether the client honored the request, use
<cite>get_full_client_certificate_chain</cite> in later phases.
The <cite>ca_certs</cite> argument is the optional CA certificate chain opaque pointer,
which can be created by the [parse_pem_cert](<a class="reference external" href="https://github.com/openresty/lua-resty-core/blob/master/lib/ngx/ssl.md#parse_pem_cert">https://github.com/openresty/lua-resty-core/blob/master/lib/ngx/ssl.md#parse_pem_cert</a>)
or [resty.opensslx509.chain](<a class="reference external" href="https://github.com/fffonion/lua-resty-openssl#restyopensslx509chain">https://github.com/fffonion/lua-resty-openssl#restyopensslx509chain</a>)
The Distinguished Name (DN) list hints of the CA certificates will be sent to clients.
If omitted, will not send any DN list to clients.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate</p>
</dd>
<dt>Example:</dt><dd><p>x509_lib = require “resty.openssl.x509”</p>
<p>chain_lib = require “resty.openssl.x509.chain”</p>
<p>res, err</p>
<p>chain = chain_lib.new()</p>
<p># err check</p>
<p>x509, err = x509_lib.new(pem_cert, “PEM”)</p>
<p># err check</p>
<p>res, err = chain:add(x509)</p>
<p># err check</p>
<p># <cite>chain.ctx</cite> is the raw data of the chain, i.e. <cite>STACK_OF(X509) *</cite></p>
<p>res, err = kong.client.tls.request_client_certificate(chain.ctx)</p>
<p>if not res:</p>
<blockquote>
<div><p># do something with err</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ca_certs</strong> (<em>cdata</em>) – The CA certificate chain opaque pointer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <cite>true</cite> if successful, or <cite>nil</cite> if it fails.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns <cite>nil</cite> if successful, or an error message if it fails.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>err</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.client.tls.set_client_verify">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_client_verify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.client.tls.set_client_verify" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Overrides the client’s verification result generated by the log serializer.
By default, the <cite>request.tls.client_verify</cite> field inside the log
generated by Kong’s log serializer is the same as the
[$ssl_client_verify](<a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_ssl_module.html#var_ssl_client_verify">https://nginx.org/en/docs/http/ngx_http_ssl_module.html#var_ssl_client_verify</a>)
Nginx variable.
Only <cite>“SUCCESS”</cite>, <cite>“NONE”</cite>, or <cite>“FAILED:&lt;reason&gt;”</cite> are accepted values.
This function does not return anything on success, and throws a Lua error
in case of a failure.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, balancer</p>
</dd>
<dt>Example:</dt><dd><p>kong.client.tls.set_client_verify(“FAILED:unknown CA”)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.cluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster</span></span><a class="headerlink" href="#kong.kong.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.cluster.get_id">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.cluster.get_id" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the unique ID for this Kong cluster. If Kong
is running in DB-less mode without a cluster ID explicitly defined,
then this method returns <cite>nil</cite>.
For hybrid mode, all control planes and data planes belonging to the same
cluster return the same cluster ID. For traditional database-based
deployments, all Kong nodes pointing to the same database also return
the same cluster ID.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>id, err = kong.cluster.get_id()</p>
<p>if err:</p>
<blockquote>
<div><p># handle errorif not id:</p>
<p># no cluster ID is available# use id here</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The v4 UUID used by this cluster as its ID.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An error message.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.ctx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ctx</span></span><a class="headerlink" href="#kong.kong.ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.ctx.shared">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shared</span></span><a class="headerlink" href="#kong.kong.ctx.shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.ctx.shared.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kong.kong.ctx.shared.get" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>get a key-value pair from Kong’s shared memory</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the per-request context data in ngx.ctx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.ctx.shared.set">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.ctx.shared.set" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>set a key-value pair in Kong’s shared memory</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p></li>
<li><p><strong>v</strong> (<em>str</em>) – value for the ctx data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.ip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ip</span></span><a class="headerlink" href="#kong.kong.ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.ip.is_trusted">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_trusted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#kong.kong.ip.is_trusted" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Depending on the <cite>trusted_ips</cite> configuration property,
this function returns whether a given IP is trusted or not.
Both ipv4 and ipv6 are supported.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>if kong.ip.is_trusted(“1.1.1.1”):</p>
<blockquote>
<div><p>kong.log(“The IP is trusted”)</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>address</strong> (<em>str</em>) – A string representing an IP address.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> if the IP is trusted, <cite>false</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.log">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log</span></span><a class="headerlink" href="#kong.kong.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.alert">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.alert" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id111"><span class="problematic" id="id112">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id113"><span class="problematic" id="id114">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id115"><span class="problematic" id="id116">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id117"><span class="problematic" id="id118">``</span></a><a href="#id119"><span class="problematic" id="id120">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.crit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">crit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.crit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id125"><span class="problematic" id="id126">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id127"><span class="problematic" id="id128">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id129"><span class="problematic" id="id130">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id131"><span class="problematic" id="id132">``</span></a><a href="#id133"><span class="problematic" id="id134">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.debug">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.debug" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id139"><span class="problematic" id="id140">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id141"><span class="problematic" id="id142">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id143"><span class="problematic" id="id144">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id145"><span class="problematic" id="id146">``</span></a><a href="#id147"><span class="problematic" id="id148">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.deprecation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deprecation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.deprecation" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Arguments given to this function can be of any type, but table arguments
are converted to strings via <cite>tostring</cite> (thus potentially calling a
table’s <cite>__tostring</cite> metamethod if set). When the last argument is a table,
it is considered as a deprecation metadata. The table can include the
following properties:
<a href="#id153"><span class="problematic" id="id154">``</span></a>` lua
{</p>
<blockquote>
<div><p>after = “2.5.0”,   – deprecated after Kong version 2.5.0 (defaults to <cite>nil</cite>)
removal = “3.0.0”, – about to be removed with Kong version 3.0.0 (defaults to <cite>nil</cite>)
trace = true,      – writes stack trace along with the deprecation message (defaults to <cite>nil</cite>)</p>
</div></blockquote>
<p>For example, the following call:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">lua</span>
<span class="pre">kong.log.deprecation(&quot;hello</span> <span class="pre">&quot;,</span> <span class="pre">&quot;world&quot;)</span>
<span class="pre">`</span></code>
would, within the core, produce a log line similar to:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">hello</span> <span class="pre">world,</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code>
If invoked from within a plugin (for example, <cite>key-auth</cite>) it would include the
namespace prefix:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">[key-auth]</span> <span class="pre">hello</span> <span class="pre">world,</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code>
And with metatable, the following call:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">lua</span>
<span class="pre">kong.log.deprecation(&quot;hello</span> <span class="pre">&quot;,</span> <span class="pre">&quot;world&quot;,</span> <span class="pre">{</span> <span class="pre">after</span> <span class="pre">=</span> <span class="pre">&quot;2.5.0&quot;,</span> <span class="pre">removal</span> <span class="pre">=</span> <span class="pre">&quot;3.0.0&quot;</span> <span class="pre">})</span>
<span class="pre">`</span></code>
would, within the core, produce a log line similar to:
<code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">plain</span>
<span class="pre">2017/07/09</span> <span class="pre">19:36:25</span> <span class="pre">[warn]</span> <span class="pre">25932#0:</span> <span class="pre">*1</span> <span class="pre">[kong]</span> <span class="pre">some_file.lua:54</span> <span class="pre">hello</span> <span class="pre">world</span> <span class="pre">(deprecated</span> <span class="pre">after</span> <span class="pre">2.5.0,</span> <span class="pre">scheduled</span> <span class="pre">for</span> <span class="pre">removal</span> <span class="pre">in</span> <span class="pre">3.0.0),</span> <span class="pre">client:</span> <span class="pre">127.0.0.1,</span> <span class="pre">server:</span> <span class="pre">localhost,</span> <span class="pre">request:</span> <span class="pre">&quot;GET</span> <span class="pre">/log</span> <span class="pre">HTTP/1.1&quot;,</span> <span class="pre">host:</span> <span class="pre">&quot;localhost&quot;</span>
<span class="pre">`</span></code></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.deprecation(“hello “, “world”)</p>
<p>kong.log.deprecation(“hello “, “world”, { after = “2.5.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { removal = “3.0.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { after = “2.5.0”, removal = “3.0.0” })</p>
<p>kong.log.deprecation(“hello “, “world”, { trace = true })</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>all params will be concatenated and stringified before being sent to the log
(if the last param is a table, it is considered as a deprecation metadata)</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.err">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.err" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id159"><span class="problematic" id="id160">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id161"><span class="problematic" id="id162">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id163"><span class="problematic" id="id164">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id165"><span class="problematic" id="id166">``</span></a><a href="#id167"><span class="problematic" id="id168">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.info">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.info" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id173"><span class="problematic" id="id174">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id175"><span class="problematic" id="id176">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id177"><span class="problematic" id="id178">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id179"><span class="problematic" id="id180">``</span></a><a href="#id181"><span class="problematic" id="id182">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.notice">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">notice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.notice" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id187"><span class="problematic" id="id188">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id189"><span class="problematic" id="id190">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id191"><span class="problematic" id="id192">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id193"><span class="problematic" id="id194">``</span></a><a href="#id195"><span class="problematic" id="id196">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.serialize">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.serialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.set_serialize_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_serialize_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.log.set_serialize_value" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets a value to be used on the <cite>serialize</cite> custom table.
Logging plugins use the output of <cite>kong.log.serialize()</cite> as a base for their logs.
This function lets you customize the log output.
It can be used to replace existing values in the output, or to delete
existing values by passing <cite>nil</cite>.
<strong>Note:</strong> The type-checking of the <cite>value</cite> parameter can take some time, so
it is deferred to the <cite>serialize()</cite> call, which happens in the log
phase in most real-usage cases.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Adds a new value to the serialized table</p>
<p>kong.log.set_serialize_value(“my_new_value”, 1)</p>
<p>assert(kong.log.serialize().my_new_value == 1)</p>
<p># Value can be a table</p>
<p>kong.log.set_serialize_value(“my”, { new = { value = 2 } })</p>
<p>assert(kong.log.serialize().my.new.value == 2)</p>
<p># It is possible to change an existing serialized value</p>
<p>kong.log.set_serialize_value(“my_new_value”, 3)</p>
<p>assert(kong.log.serialize().my_new_value == 3)</p>
<p># Unset an existing value by setting it to nil</p>
<p>kong.log.set_serialize_value(“my_new_value”, nil)</p>
<p>assert(kong.log.serialize().my_new_value == nil)</p>
<p># Dots in the key are interpreted as table accesses</p>
<p>kong.log.set_serialize_value(“my.new.value”, 4)</p>
<p>assert(kong.log.serialize().my.new_value == 4)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The name of the field.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – Value to be set. When a table is used, its keys must be numbers, strings, or booleans, and its values can be numbers, strings, or other tables like itself, recursively.</p></li>
<li><p><strong>options</strong> (<em>table</em>) – Can contain two entries: options.mode can be <cite>set</cite> (the default, always sets), <cite>add</cite> (only add if entry does not already exist) and <cite>replace</cite> (only change value if it already exists).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The request information table.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.log.warn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.log.warn" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Similar to <cite>kong.log()</cite>, but the produced log has the severity given by
<cite>&lt;level&gt;</cite>, instead of <cite>notice</cite>. The supported levels are:
* <cite>kong.log.alert()</cite>
* <cite>kong.log.crit()</cite>
* <cite>kong.log.err()</cite>
* <cite>kong.log.warn()</cite>
* <cite>kong.log.notice()</cite>
* <cite>kong.log.info()</cite>
* <cite>kong.log.debug()</cite>
Logs have the same format as that of <cite>kong.log()</cite>. For
example, the following call:
<a href="#id201"><span class="problematic" id="id202">``</span></a>` lua</p>
<blockquote>
<div><p>kong.log.err(“hello “, “world”)</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">would,</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">core,</span> <span class="pre">produce</span> <span class="pre">a</span> <span class="pre">log</span> <span class="pre">line</span> <span class="pre">similar</span> <span class="pre">to:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id203"><span class="problematic" id="id204">*</span></a>1 [kong] some_file.lua:54 hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">If</span> <span class="pre">invoked</span> <span class="pre">from</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">plugin</span> <span class="pre">(for</span> <span class="pre">example,</span> <span class="pre">`key-auth`)</span> <span class="pre">it</span> <span class="pre">would</span> <span class="pre">include</span> <span class="pre">the</span>
<span class="pre">namespace</span> <span class="pre">prefix:</span>
<span class="pre">`</span></code> plain
2017/07/09 19:36:25 [error] 25932#0: <a href="#id205"><span class="problematic" id="id206">*</span></a>1 [kong] some_file.lua:54 [key-auth] hello world, client: 127.0.0.1, server: localhost, request: “GET /log HTTP/1.1”, host: “localhost”
<a href="#id207"><span class="problematic" id="id208">``</span></a><a href="#id209"><span class="problematic" id="id210">`</span></a></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>init_worker, certificate, rewrite, access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.warn(“something require attention”)</p>
<p>kong.log.err(“something failed: “, err)</p>
<p>kong.log.alert(“something requires immediate action”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>All params will be concatenated and stringified before being sent to the log.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.nginx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nginx</span></span><a class="headerlink" href="#kong.kong.nginx" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.get_ctx">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_ctx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kong.kong.nginx.get_ctx" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>get a key-value pair from Kong’s per-request context</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the per-request context data in ngx.ctx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.get_statistics">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_statistics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.nginx.get_statistics" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns various connection and request metrics exposed by
Nginx, similar to those reported by the
[ngx_http_stub_status_module](<a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_stub_status_module.html#data">https://nginx.org/en/docs/http/ngx_http_stub_status_module.html#data</a>).
The following fields are included in the returned table:
* <cite>connections_active</cite> - the current number of active client connections including <cite>connections_waiting</cite>.
* <cite>connections_reading</cite> - the current number of connections where nginx is reading the request header.
* <cite>connections_writing</cite> - the current number of connections where nginx is writing the response back to the client.
* <cite>connections_waiting</cite> - the current number of idle client connections waiting for a request.
* <cite>connections_accepted</cite> - the total number of accepted client connections.
* <cite>connections_handled</cite> - the total number of handled connections. Same as <cite>connections_accepted</cite> unless some resource limits have been reached</p>
<blockquote>
<div><p>(for example, the [<cite>worker_connections</cite>](<a class="reference external" href="https://nginx.org/en/docs/ngx_core_module.html#worker_connections">https://nginx.org/en/docs/ngx_core_module.html#worker_connections</a>) limit).</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>total_requests</cite> - the total number of client requests.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>nginx_statistics = kong.nginx.get_statistics()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Nginx connections and requests statistics</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.get_subsystem">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_subsystem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.nginx.get_subsystem" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the subsystem name</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.get_tls1_version_str">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_tls1_version_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.nginx.get_tls1_version_str" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the TLSv1 version string</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.get_var">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.nginx.get_var" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the NGINX version string</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.req_start_time">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">req_start_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.nginx.req_start_time" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>get the current request’s start timestamp</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>req_start_time</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.set_ctx">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_ctx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">any</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.nginx.set_ctx" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>set a key-value pair in Kong’s per-request context</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p></li>
<li><p><strong>any</strong> (<em>str</em>) – value for the ctx data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.nginx.shared">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shared</span></span><a class="headerlink" href="#kong.kong.nginx.shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.shared.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kong.kong.nginx.shared.get" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>get a key-value pair from Kong’s shared memory</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the per-request context data in ngx.ctx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.nginx.shared.set">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.nginx.shared.set" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>set a key-value pair in Kong’s shared memory</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>str</em>) – key for the ctx data</p></li>
<li><p><strong>v</strong> (<em>str</em>) – value for the ctx data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.node">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node</span></span><a class="headerlink" href="#kong.kong.node" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.node.get_hostname">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_hostname</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.node.get_hostname" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the name used by the local machine.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>hostname = kong.node.get_hostname()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The local machine hostname.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.node.get_id">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.node.get_id" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the ID used by this node to describe itself.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>id = kong.node.get_id()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The v4 UUID used by this node as its ID.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.node.get_memory_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_memory_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.node.get_memory_stats" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns memory usage statistics about this node.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>res = kong.node.get_memory_stats()</p>
<p># res will have the following structure:</p>
<p>{</p>
<p>lua_shared_dicts = {</p>
<p>kong = {</p>
<p>allocated_slabs = 12288,</p>
<p>capacity = 24576</p>
<p>},</p>
<p>kong_db_cache = {</p>
<p>allocated_slabs = 12288,</p>
<p>capacity = 12288</p>
<p>}</p>
<p>},</p>
<p>workers_lua_vms = {</p>
<p>{</p>
<p>http_allocated_gc = 1102,</p>
<p>pid = 18004</p>
<p>},</p>
<p>{</p>
<p>http_allocated_gc = 1102,</p>
<p>pid = 18005</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>res = kong.node.get_memory_stats(“k”, 1)</p>
<p># res will have the following structure:</p>
<p>{</p>
<p>lua_shared_dicts = {</p>
<p>kong = {</p>
<p>allocated_slabs = “12.0 KiB”,</p>
<p>capacity = “24.0 KiB”,</p>
<p>},</p>
<p>kong_db_cache = {</p>
<p>allocated_slabs = “12.0 KiB”,</p>
<p>capacity = “12.0 KiB”,</p>
<p>}</p>
<p>},</p>
<p>workers_lua_vms = {</p>
<p>{</p>
<p>http_allocated_gc = “1.1 KiB”,</p>
<p>pid = 18004</p>
<p>},</p>
<p>{</p>
<p>http_allocated_gc = “1.1 KiB”,</p>
<p>pid = 18005</p>
<p>}</p>
<p>}</p>
<p>}</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit</strong> (<em>str</em>) – The unit that memory is reported in. Can be
any of <cite>b/B</cite>, <cite>k/K</cite>, <cite>m/M</cite>, or <cite>g/G</cite> for bytes, kibibytes, mebibytes,
or gibibytes, respectively. Defaults to <cite>b</cite> (bytes).</p></li>
<li><p><strong>scale</strong> (<em>number</em>) – The number of digits to the right of the decimal
point. Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table containing memory usage statistics for this node.
If <cite>unit</cite> is <cite>b/B</cite> (the default), reported values are Lua numbers.
Otherwise, reported values are strings with the unit as a suffix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.request">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">request</span></span><a class="headerlink" href="#kong.kong.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mimetype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.request.get_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the request data as a key/value table.
A high-level convenience function.
The body is parsed with the most appropriate format:
* If <cite>mimetype</cite> is specified, it decodes the body with the requested</p>
<blockquote>
<div><p>content type (if supported). This takes precedence over any content type
present in the request.
The optional argument <cite>mimetype</cite> can be one of the following strings:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>application/x-www-form-urlencoded</cite></p></li>
<li><p><cite>application/json</cite></p></li>
<li><p><cite>multipart/form-data</cite></p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Whether <cite>mimetype</cite> is specified or a request content type is otherwise
present in the request, each content type behaves as follows:
* If the request content type is <cite>application/x-www-form-urlencoded</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Returns the body as form-encoded.</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>If the request content type is <cite>multipart/form-data</cite>:
* Decodes the body as multipart form data</p>
<blockquote>
<div><p>(same as <cite>multipart(kong.request.get_raw_body(),
kong.request.get_header(“Content-Type”)):get_all()</cite> ).</p>
</div></blockquote>
</li>
<li><p>If the request content type is <cite>application/json</cite>:
* Decodes the body as JSON</p>
<blockquote>
<div><p>(same as <cite>json.decode(kong.request.get_raw_body())</cite>).</p>
</div></blockquote>
<ul class="simple">
<li><p>JSON types are converted to matching Lua types.</p></li>
</ul>
</li>
<li><p>If the request contains none of the above and the <cite>mimetype</cite> argument is
not set, returns <cite>nil</cite> and an error message indicating the
body could not be parsed.</p></li>
</ul>
<p>The optional argument <cite>max_args</cite> can be used to set a limit on the number
of form arguments parsed for <cite>application/x-www-form-urlencoded</cite> payloads.
The third return value is string containing the mimetype used to parsed
the body (as per the <cite>mimetype</cite> argument), allowing the caller to identify
what MIME type the body was parsed as.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>body, err, mimetype = kong.request.get_body()</p>
<p>body.name # “John Doe”</p>
<p>body.age  # “42”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mimetype</strong> (<em>str</em>) – The MIME type.</p></li>
<li><p><strong>max_args</strong> (<em>number</em>) – Sets a limit on the maximum number of parsed
arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table representation of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An error message.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mimetype The MIME type used.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_forwarded_host">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_host</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_forwarded_host" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the host component of the request’s URL or the value of the “host”
header. Unlike <cite>kong.request.get_host()</cite>, this function also considers
<cite>X-Forwarded-Host</cite> if it comes from a trusted source. The returned value
is normalized to lowercase.
Whether this function considers <cite>X-Forwarded-Host</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_host() # “example.com”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded host.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_forwarded_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_forwarded_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path component of the request’s URL, but also considers
<cite>X-Forwarded-Path</cite> if it comes from a trusted source. The value
is returned as a Lua string.
Whether this function considers <cite>X-Forwarded-Path</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not do any normalization on the request path.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_path() # /path</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded path.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_forwarded_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.request.get_forwarded_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the port component of the request’s URL, but also considers
<cite>X-Forwarded-Host</cite> if it comes from a trusted source. The value
is returned as a Lua number.
Whether this function considers <cite>X-Forwarded-Proto</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.
When running Kong behind the L4 port mapping (or forwarding), you can also
configure:
* [port_maps](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#port_maps">https://docs.konghq.com/gateway/latest/reference/configuration/#port_maps</a>)
The <cite>port_maps</cite> configuration parameter enables this function to return the
port to which the port Kong is listening to is mapped to (in case they differ).</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_port() # 1234</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded port.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_forwarded_prefix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_prefix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_forwarded_prefix" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the prefix path component of the request’s URL that Kong stripped
before proxying to upstream. It also checks if <cite>X-Forwarded-Prefix</cite> comes
from a trusted source, and uses it as-is when given. The value is returned
as a Lua string.
If a trusted <cite>X-Forwarded-Prefix</cite> is not passed, this function must be
called after Kong has run its router (<cite>access</cite> phase),
as the Kong router may strip the prefix of the request path. That stripped
path becomes the return value of this function, unless there is already
a trusted <cite>X-Forwarded-Prefix</cite> header in the request.
Whether this function considers <cite>X-Forwarded-Prefix</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not do any normalization on the request path prefix.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_prefix() # /prefix</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded path prefix or <cite>nil</cite> if the prefix was
not stripped.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_forwarded_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_forwarded_scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_forwarded_scheme" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the scheme component of the request’s URL, but also considers
<cite>X-Forwarded-Proto</cite> if it comes from a trusted source. The returned
value is normalized to lowercase.
Whether this function considers <cite>X-Forwarded-Proto</cite> or not depends on
several Kong configuration parameters:
* [trusted_ips](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips">https://docs.konghq.com/gateway/latest/reference/configuration/#trusted_ips</a>)
* [real_ip_header](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_header</a>)
* [real_ip_recursive](<a class="reference external" href="https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive">https://docs.konghq.com/gateway/latest/reference/configuration/#real_ip_recursive</a>)
<strong>Note</strong>: Kong does not offer support for the Forwarded HTTP Extension
(RFC 7239) since it is not supported by ngx_http_realip_module.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_forwarded_scheme() # “https”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The forwarded scheme.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified request header.
The returned value is either a <cite>string</cite>, or can be <cite>nil</cite> if a header with
<cite>name</cite> was not found in the request. If a header with the same name is
present multiple times in the request, this function returns the value
of the first occurrence of this header.
Header names in are case-insensitive and are normalized to lowercase, and
dashes (<cite>-</cite>) can be written as underscores (<cite>_</cite>); that is, the header
<cite>X-Custom-Header</cite> can also be retrieved as <cite>x_custom_header</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request with the following headers:</p>
<p># Host: foo.com</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>kong.request.get_header(“Host”)            # “foo.com”</p>
<p>kong.request.get_header(“x-custom-header”) # “bla”</p>
<p>kong.request.get_header(“X-Another”)       # “foo bar”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the name of the header to be returned</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the header or nil if not present</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.request.get_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a Lua table holding the request headers. Keys are header names.
Values are either a string with the header value, or an array of strings
if a header was sent multiple times. Header names in this table are
case-insensitive and are normalized to lowercase, and dashes (<cite>-</cite>) can be
written as underscores (<cite>_</cite>); that is, the header <cite>X-Custom-Header</cite> can
also be retrieved as <cite>x_custom_header</cite>.
By default, this function returns up to <strong>100</strong> headers. The optional
<cite>max_headers</cite> argument can be specified to customize this limit, but must
be greater than <strong>1</strong> and not greater than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request with the following headers:</p>
<p># Host: foo.com</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>headers = kong.request.get_headers()</p>
<p>headers.host            # “foo.com”</p>
<p>headers.x_custom_header # “bla”</p>
<p>headers.x_another[1]    # “foo bar”</p>
<p>headers[“X-Another”][2] # “baz”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_headers</strong> (<em>number</em>) – Sets a limit on the maximum number of
parsed headers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The request headers in table form.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_host">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_host</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_host" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the host component of the request’s URL, or the value of the
“Host” header. The returned value is normalized to lowercase form.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_host() # “example.com”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The hostname.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_http_version">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_http_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.request.get_http_version" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP version used by the client in the request as a Lua
number, returning values such as <cite>1</cite>, <cite>1.1</cite>, <cite>2.0</cite>, or <cite>nil</cite> for
unrecognized values.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_http_version() # 1.1</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The HTTP version as a Lua number.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_method">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_method" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP method of the request. The value is normalized to
uppercase.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_method() # “GET”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The request method.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the normalized path component of the request’s URL. The return
value is the same as <cite>kong.request.get_raw_path()</cite> but normalized according
to RFC 3986 section 6:
* Percent-encoded values of unreserved characters are decoded (<cite>%20</cite></p>
<blockquote>
<div><p>becomes ` <a href="#id215"><span class="problematic" id="id216">`</span></a>).</p>
</div></blockquote>
<ul class="simple">
<li><p>Percent-encoded values of reserved characters have their hexidecimal
value uppercased (<cite>%2f</cite> becomes <cite>%2F</cite>).</p></li>
<li><p>Relative path elements (<cite>/.</cite> and <cite>/..</cite>) are dereferenced.</p></li>
<li><p>Duplicate slashes are consolidated (<cite>//</cite> becomes <cite>/</cite>).</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./">https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./</a></p>
<p>kong.request.get_path() # “/t/Abc 123ø%2F/test/”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the path</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_path_with_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_path_with_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_path_with_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path, including the query string if any. No
transformations or normalizations are done.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies?movie=foo">https://example.com:1234/v1/movies?movie=foo</a></p>
<p>kong.request.get_path_with_query() # “/v1/movies?movie=foo”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The path with the query string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_port">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.request.get_port" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the port component of the request’s URL. The value is returned
as a Lua number.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>certificate, rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_port() # 1234</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The port.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.request.get_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the table of query arguments obtained from the query string. Keys
are query argument names. Values are either a string with the argument
value, a boolean <cite>true</cite> if an argument was not given a value, or an array
if an argument was given in the query string multiple times. Keys and
values are unescaped according to URL-encoded escaping rules.
Note that a query string <cite>?foo&amp;bar</cite> translates to two boolean <cite>true</cite>
arguments, and <cite>?foo=&amp;bar=</cite> translates to two string arguments containing
empty strings.
By default, this function returns up to <strong>100</strong> arguments. The optional
<cite>max_args</cite> argument can be specified to customize this limit, but must be
greater than <strong>1</strong> and not greater than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request GET /test?foo=hello%20world&amp;bar=baz&amp;zzz&amp;blo=&amp;bar=bla&amp;bar</p>
<p>for k, v in pairs(kong.request.get_query()) do</p>
<p>kong.log.inspect(k, v)# Will print</p>
<p># “foo” “hello world”</p>
<p># “bar” {“baz”, “bla”, true}</p>
<p># “zzz” true</p>
<p># “blo” “”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_args</strong> (<em>number</em>) – Sets a limit on the maximum number of parsed
arguments.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table representation of the query string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_query_arg">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_query_arg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#kong.kong.request.get_query_arg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified argument, obtained from the query
arguments of the current request.
The returned value is either a <cite>string</cite>, a boolean <cite>true</cite> if an
argument was not given a value, or <cite>nil</cite> if no argument with <cite>name</cite> was
found.
If an argument with the same name is present multiple times in the
query string, this function returns the value of the first occurrence.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request GET /test?foo=hello%20world&amp;bar=baz&amp;zzz&amp;blo=&amp;bar=bla&amp;bar</p>
<p>kong.request.get_query_arg(“foo”) # “hello world”</p>
<p>kong.request.get_query_arg(“bar”) # “baz”</p>
<p>kong.request.get_query_arg(“zzz”) # true</p>
<p>kong.request.get_query_arg(“blo”) # “”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value of the argument.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_raw_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_body</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="headerlink" href="#kong.kong.request.get_raw_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the plain request body.
If the body has no size (empty), this function returns an empty string.
If the size of the body is greater than the Nginx buffer size (set by
<cite>client_body_buffer_size</cite>), this function fails and returns an error
message explaining this limitation.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a body with payload “Hello, Earth!”:</p>
<p>kong.request.get_raw_body():gsub(“Earth”, “Mars”) # “Hello, Mars!”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The plain request body.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_raw_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_raw_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the path component of the request’s URL. It is not normalized in
any way and does not include the query string.
<strong>NOTE:</strong> Using the raw path to perform string comparision during request
handling (such as in routing, ACL/authorization checks, setting rate-limit
keys, etc) is widely regarded as insecure, as it can leave plugin code
vulnerable to path traversal attacks. Prefer <cite>kong.request.get_path()</cite> for
such use cases.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./?movie=foo">https://example.com/t/Abc%20123%C3%B8%2f/parent/..//test/./?movie=foo</a></p>
<p>kong.request.get_raw_path() # “/t/Abc%20123%C3%B8%2f/parent/..//test/./”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The path.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_raw_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_raw_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the query component of the request’s URL. It is not normalized in
any way (not even URL-decoding of special characters) and does not
include the leading <cite>?</cite> character.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com/foo?msg=hello%20world&amp;bla=&amp;bar">https://example.com/foo?msg=hello%20world&amp;bla=&amp;bar</a></p>
<p>kong.request.get_raw_query() # “msg=hello%20world&amp;bla=&amp;bar”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The query component of the request’s URL.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.request.get_scheme" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the scheme component of the request’s URL. The returned value is
normalized to lowercase form.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a request to <a class="reference external" href="https://example.com:1234/v1/movies">https://example.com:1234/v1/movies</a></p>
<p>kong.request.get_scheme() # “https”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string like <cite>“http”</cite> or <cite>“https”</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_start_time">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_start_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.request.get_start_time" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the request start time, in Unix epoch milliseconds.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.request.get_start_time() # 1649960273000</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The timestamp</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.request.get_uri_captures">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_uri_captures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.request.get_uri_captures" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the URI captures matched by the router.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>captures = kong.request.get_uri_captures()</p>
<p>for idx, value in ipairs(captures.unnamed) do</p>
<p># do what you want to capturesfor name, value in pairs(captures.named) do</p>
<p># do what you want to captures</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tables containing unamed and named captures.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.response">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">response</span></span><a class="headerlink" href="#kong.kong.response" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.add_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.add_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Adds a response header with the given value. Unlike
<cite>kong.response.set_header()</cite>, this function does not remove any existing
header with the same name. Instead, another header with the same name is
added to the response. If no header with this name already exists on
the response, then it is added with the given value, similarly to
<cite>kong.response.set_header().</cite></p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.add_header(“Cache-Control”, “no-cache”)</p>
<p>kong.response.add_header(“Cache-Control”, “no-store”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The header name.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The header value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.clear_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.clear_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Removes all occurrences of the specified header in the response sent to
the client.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_header(“X-Foo”, “foo”)</p>
<p>kong.response.add_header(“X-Foo”, “bar”)</p>
<p>kong.response.clear_header(“X-Foo”)</p>
<p># from here onwards, no X-Foo headers will exist in the response</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the header to be cleared</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.error">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.error" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function interrupts the current processing and produces an error
response.
It is recommended to use this function in conjunction with the <cite>return</cite>
operator, to better reflect its meaning:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">return</span> <span class="pre">kong.response.error(500,</span> <span class="pre">&quot;Error&quot;,</span> <span class="pre">{[&quot;Content-Type&quot;]</span> <span class="pre">=</span> <span class="pre">&quot;text/html&quot;})</span>
<span class="pre">`</span></code>
1. The <cite>status</cite> argument sets the status code of the response that
is seen by the client. The status code must an error code, that is,
greater than 399.
2. The optional <cite>message</cite> argument sets the message describing
the error, which is written in the body.
3. The optional <cite>headers</cite> argument can be a table specifying response
headers to send. If specified, its behavior is similar to
<cite>kong.response.set_headers()</cite>.</p>
<blockquote>
<div><p>This method sends the response formatted in JSON, XML, HTML or plaintext.
The actual format is determined using one of the following options, in
this order:
- Manually specified in the <cite>headers</cite> argument using the <cite>Content-Type</cite>
header.
- Conforming to the <cite>Accept</cite> header from the request.
- If there is no setting in the <cite>Content-Type</cite> or <cite>Accept</cite> header, the
response defaults to JSON format. Also see the <cite>Content-Length</cite>
header in the produced response for convenience.</p>
</div></blockquote>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, admin_api, header_filter, only, if, body, is, nil</p>
</dd>
<dt>Example:</dt><dd><p>return kong.response.error(403, “Access Forbidden”, {</p>
<p>[“Content-Type”] = “text/plain”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.error(403, “Access Forbidden”)</p>
<p># -</p>
<p>return kong.response.error(403)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>number</em>) – The status to be used (&gt;399).</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The error message to be used.</p></li>
<li><p><strong>headers</strong> (<em>table</em>) – The headers to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.exit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.exit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function interrupts the current processing and produces a response.
It is typical to see plugins using it to produce a response before Kong
has a chance to proxy the request (e.g. an authentication plugin rejecting
a request, or a caching plugin serving a cached response).
It is recommended to use this function in conjunction with the <cite>return</cite>
operator, to better reflect its meaning:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">return</span> <span class="pre">kong.response.exit(200,</span> <span class="pre">&quot;Success&quot;)</span>
<span class="pre">`</span></code>
Calling <cite>kong.response.exit()</cite> interrupts the execution flow of
plugins in the current phase. Subsequent phases will still be invoked.
For example, if a plugin calls <cite>kong.response.exit()</cite> in the <cite>access</cite>
phase, no other plugin is executed in that phase, but the
<cite>header_filter</cite>, <cite>body_filter</cite>, and <cite>log</cite> phases are still executed,
along with their plugins. Plugins should be programmed defensively
against cases when a request is <strong>not</strong> proxied to the Service, but
instead is produced by Kong itself.
1. The first argument <cite>status</cite> sets the status code of the response that
is seen by the client.</p>
<blockquote>
<div><p>In L4 proxy mode, the <cite>status</cite> code provided is primarily for logging
and statistical purposes, and is not visible to the client directly.
In this mode, only the following status codes are supported:
* 200 - OK
* 400 - Bad request
* 403 - Forbidden
* 500 - Internal server error
* 502 - Bad gateway
* 503 - Service unavailable</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>The second, optional, <cite>body</cite> argument sets the response body. If it is
a string, no special processing is done, and the body is sent
as-is.  It is the caller’s responsibility to set the appropriate
<cite>Content-Type</cite> header via the third argument.
As a convenience, <cite>body</cite> can be specified as a table. In that case,
the <cite>body</cite> is JSON-encoded and has the <cite>application/json</cite> Content-Type
header set.
On gRPC, we cannot send the <cite>body</cite> with this function, so
it sends <cite>“body”</cite> in the <cite>grpc-message</cite> header instead.
* If the body is a table, it looks for the <cite>message</cite> field in the body,
and uses that as a <cite>grpc-message</cite> header.
* If you specify <cite>application/grpc</cite> in the <cite>Content-Type</cite> header, the
body is sent without needing the <cite>grpc-message</cite> header.
In L4 proxy mode, <cite>body</cite> can only be <cite>nil</cite> or a string. Automatic JSON
encoding is not available. When <cite>body</cite> is provided, depending on the
value of <cite>status</cite>, the following happens:
* When <cite>status</cite> is 500, 502 or 503, then <cite>body</cite> is logged in the Kong
error log file.
* When the <cite>status</cite> is anything else, <cite>body</cite> is sent back to the L4 client.</p></li>
<li><p>The third, optional, <cite>headers</cite> argument can be a table specifying
response headers to send. If specified, its behavior is similar to
<cite>kong.response.set_headers()</cite>. This argument is ignored in L4 proxy mode.</p></li>
</ol>
<p>Unless manually specified, this method automatically sets the
<cite>Content-Length</cite> header in the produced response for convenience.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>preread, rewrite, access, admin_api, header_filter, only, if, body, is, nil</p>
</dd>
<dt>Example:</dt><dd><p>return kong.response.exit(403, “Access Forbidden”, {</p>
<p>[“Content-Type”] = “text/plain”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.exit(403, [[{“message”:”Access Forbidden”}]], {</p>
<p>[“Content-Type”] = “application/json”,</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p>return kong.response.exit(403, { message = “Access Forbidden” }, {</p>
<p>[“WWW-Authenticate”] = “Basic”</p>
<p>})</p>
<p># -</p>
<p># In L4 proxy mode</p>
<p>return kong.response.exit(200, “Success”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<em>number</em>) – The status to be used.</p></li>
<li><p><strong>body</strong> (<em>bytes</em>) – The body to be used.</p></li>
<li><p><strong>headers</strong> (<em>table</em>) – The headers to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.get_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.response.get_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified response header, as would be seen by
the client once received.
The list of headers returned by this function can consist of both response
headers from the proxied Service _and_ headers added by Kong (e.g. via
<cite>kong.response.add_header()</cite>).
The return value is either a <cite>string</cite>, or can be <cite>nil</cite> if a header with
<cite>name</cite> is not found in the response. If a header with the same name is
present multiple times in the request, this function returns the value
of the first occurrence of this header.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given a response with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>kong.response.get_header(“x-custom-header”) # “bla”</p>
<p>kong.response.get_header(“X-Another”)       # “foo bar”</p>
<p>kong.response.get_header(“X-None”)          # nil</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the header.
Header names are case-insensitive and dashes (<cite>-</cite>) can be written as
underscores (<cite>_</cite>). For example, the header <cite>X-Custom-Header</cite> can also be
retrieved as <cite>x_custom_header</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the header.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.get_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.response.get_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a Lua table holding the response headers. Keys are header names.
Values are either a string with the header value, or an array of strings
if a header was sent multiple times. Header names in this table are
case-insensitive and are normalized to lowercase, and dashes (<cite>-</cite>) can be
written as underscores (<cite>_</cite>). For example, the header <cite>X-Custom-Header</cite> can
also be retrieved as <cite>x_custom_header</cite>.
A response initially has no headers. Headers are added when a plugin
short-circuits the proxying by producing a header
(e.g. an authentication plugin rejecting a request), or if the request has
been proxied, and one of the latter execution phases is currently running.
Unlike <cite>kong.service.response.get_headers()</cite>, this function returns <em>all</em>
headers as the client would see them upon reception, including headers
added by Kong itself.
By default, this function returns up to <strong>100</strong> headers. The optional
<cite>max_headers</cite> argument can be specified to customize this limit, but must
be greater than <strong>1</strong> and equal to or less than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p># Given an response from the Service with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>headers = kong.response.get_headers()</p>
<p>headers.x_custom_header # “bla”</p>
<p>headers.x_another[1]    # “foo bar”</p>
<p>headers[“X-Another”][2] # “baz”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_headers</strong> (<em>number</em>) – Limits the number of headers parsed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>headers A table representation of the headers in the
response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>err If more headers than <cite>max_headers</cite> were present,
returns a string with the error <cite>“truncated”</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.get_source">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_source</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.response.get_source" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function helps determine where the current response originated
from. Since Kong is a reverse proxy, it can short-circuit a request and
produce a response of its own, or the response can come from the proxied
Service.
Returns a string with three possible values:
* <cite>“exit”</cite> is returned when, at some point during the processing of the</p>
<blockquote>
<div><p>request, there has been a call to <cite>kong.response.exit()</cite>. This happens
when the request was short-circuited by a plugin or by Kong
itself (e.g. invalid credentials).</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>“error”</cite> is returned when an error has happened while processing the
request. For example, a timeout while connecting to the upstream
service.</p></li>
<li><p><cite>“service”</cite> is returned when the response was originated by successfully
contacting the proxied Service.</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>if kong.response.get_source() == “service”:</p>
<blockquote>
<div><p>kong.log(“The response comes from the Service”)</p>
</div></blockquote>
<p>elseif kong.response.get_source() == “error”:</p>
<blockquote>
<div><p>kong.log(“There was an error while processing the request”)</p>
</div></blockquote>
<p>elseif kong.response.get_source() == “exit”:</p>
<blockquote>
<div><p>kong.log(“There was an early exit while processing the request”)</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The source.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.get_status">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.response.get_status" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP status code currently set for the downstream response (as
a Lua number).
If the request was proxied (as per <cite>kong.response.get_source()</cite>), the
return value is the response from the Service (identical to
<cite>kong.service.response.get_status()</cite>).
If the request was _not_ proxied and the response was produced by Kong
itself (i.e. via <cite>kong.response.exit()</cite>), the return value is
returned as-is.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>header_filter, response, body_filter, log, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.get_status() # 200</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>status The HTTP status code currently set for the
downstream response.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.set_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.set_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets a response header with the given value. This function overrides any
existing header with the same name.
Note: Underscores in header names are automatically transformed into dashes
by default. If you want to deactivate this behavior, set the
<cite>lua_transform_underscores_in_response_headers</cite> Nginx config option to <cite>off</cite>.
This setting can be set in the Kong Config file:</p>
<blockquote>
<div><p>nginx_http_lua_transform_underscores_in_response_headers = off</p>
</div></blockquote>
<p>Be aware that changing this setting might break any plugins that
rely on the automatic underscore conversion.
You cannot set Transfer-Encoding header with this function. It will be ignored.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_header(“X-Foo”, “value”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the header</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The new value for the header.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.set_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.set_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the headers for the response. Unlike <cite>kong.response.set_header()</cite>,
the <cite>headers</cite> argument must be a table in which each key is a string
corresponding to a header’s name, and each value is a string, or an
array of strings.
The resulting headers are produced in lexicographical order. The order of
entries with the same name (when values are given as an array) is
retained.
This function overrides any existing header bearing the same name as those
specified in the <cite>headers</cite> argument. Other headers remain unchanged.
You cannot set Transfer-Encoding header with this function. It will be ignored.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_headers({</p>
<p>[“Bla”] = “boo”,</p>
<p>[“X-Foo”] = “foo3”,</p>
<p>[“Cache-Control”] = { “no-store”, “no-cache” }</p>
<p>})</p>
<p># Will add the following headers to the response, in this order:</p>
<p># X-Bar: bar1</p>
<p># Bla: boo</p>
<p># Cache-Control: no-store</p>
<p># Cache-Control: no-cache</p>
<p># X-Foo: foo3</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>headers</strong> (<em>table</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.response.set_status">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.response.set_status" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Allows changing the downstream response HTTP status code before sending it
to the client.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, header_filter, response, admin_api</p>
</dd>
<dt>Example:</dt><dd><p>kong.response.set_status(404)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>status</strong> (<em>number</em>) – The new status.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.router">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">router</span></span><a class="headerlink" href="#kong.kong.router" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.router.get_route">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_route</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.router.get_route" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the current <cite>route</cite> entity. The request is matched against this
route.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>route = kong.router.get_route()</p>
<p>protocols = route.protocols</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <cite>route</cite> entity.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.router.get_service">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_service</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">table</span></span></span><a class="headerlink" href="#kong.kong.router.get_service" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the current <cite>service</cite> entity. The request is targeted to this
upstream service.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access, header_filter, response, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>if kong.router.get_service():</p>
<blockquote>
<div><p># routed by route &amp; service entities</p>
</div></blockquote>
<p>else:</p>
<blockquote>
<div><p># routed by a route without a service</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <cite>service</cite> entity.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>table</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.service">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">service</span></span><a class="headerlink" href="#kong.kong.service" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.service.request">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">request</span></span><a class="headerlink" href="#kong.kong.service.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.add_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.add_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Adds a request header with the given value to the request to the Service. Unlike
<cite>kong.service.request.set_header()</cite>, this function doesn’t remove any existing
headers with the same name. Instead, several occurrences of the header will be
present in the request. The order in which headers are added is retained.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.add_header(“Cache-Control”, “no-cache”)</p>
<p>kong.service.request.add_header(“Cache-Control”, “no-store”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>str</em>) – The header name. Example: “Cache-Control”.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The header value. Example: “no-cache”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.clear_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.clear_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Removes all occurrences of the specified header from the request to the Service.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_header(“X-Foo”, “foo”)</p>
<p>kong.service.request.add_header(“X-Foo”, “bar”)</p>
<p>kong.service.request.clear_header(“X-Foo”)</p>
<p># from here onwards, no X-Foo headers will exist in the request</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>header</strong> (<em>str</em>) – The header name. Example: “X-Foo”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.
The function does not throw an error if no header was removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.disable_tls">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">disable_tls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.request.disable_tls" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Disables the TLS handshake to upstream for [ngx_stream_proxy_module](<a class="reference external" href="https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html">https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html</a>).
This overrides the [proxy_ssl](<a class="reference external" href="https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html#proxy_ssl">https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html#proxy_ssl</a>) directive, effectively setting it to <cite>off</cite>
for the current stream session.
Once this function has been called, it is not possible to re-enable TLS handshake for the current session.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>preread, balancer</p>
</dd>
<dt>Example:</dt><dd><p>ok, err = kong.service.request.disable_tls()</p>
<p>if not ok:</p>
<blockquote>
<div><p># do something with error</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>true</cite> if the operation succeeded, <cite>nil</cite> if an error occurred.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An error message describing the error if there was one.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.enable_buffering">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enable_buffering</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.enable_buffering" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Enables buffered proxying, which allows plugins to access Service body and
response headers at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.enable_buffering()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mimetype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.request.set_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the body of the request to the Service. Unlike
<cite>kong.service.request.set_raw_body()</cite>, the <cite>args</cite> argument must be a table, and
is encoded with a MIME type.  The encoding MIME type can be specified in
the optional <cite>mimetype</cite> argument, or if left unspecified, is chosen based
on the <cite>Content-Type</cite> header of the client’s request.
Behavior based on MIME type in the <cite>Content-Type</cite> header:
* <cite>application/x-www-form-urlencoded</cite>: Encodes the arguments as</p>
<blockquote>
<div><p>form-encoded. Keys are produced in lexicographical
order. The order of entries within the same key (when values are
given as an array) is retained. Any string values given are URL-encoded.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>multipart/form-data</cite>: Encodes the arguments as multipart form data.</p></li>
<li><p><cite>application/json</cite>: Encodes the arguments as JSON (same as
<cite>kong.service.request.set_raw_body(json.encode(args))</cite>). Lua types are
converted to matching JSON types.</p></li>
</ul>
<p>If the MIME type is none of the above, this function returns <cite>nil</cite> and
an error message indicating the body could not be encoded.
If the <cite>mimetype</cite> argument is specified, the <cite>Content-Type</cite> header is
set accordingly in the request to the Service.
If further control of the body generation is needed, a raw body can be given as
a string with <cite>kong.service.request.set_raw_body()</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.set_header(“application/json”)</p>
<p>ok, err = kong.service.request.set_body({</p>
<p>name = “John Doe”,</p>
<p>age = 42,</p>
<p>numbers = {1, 2, 3}</p>
<p>})</p>
<p># Produces the following JSON body:</p>
<p># { “name”: “John Doe”, “age”: 42, “numbers”:[1, 2, 3] }</p>
<p>ok, err = kong.service.request.set_body({</p>
<p>foo = “hello world”,</p>
<p>bar = {“baz”, “bla”, true},</p>
<p>zzz = true,</p>
<p>blo = “”</p>
<p>}, “application/x-www-form-urlencoded”)</p>
<p># Produces the following body:</p>
<p># bar=baz&amp;bar=bla&amp;bar&amp;blo=&amp;foo=hello%20world&amp;zzz</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>table</em>) – A table with data to be converted to the appropriate format
and stored in the body.</p></li>
<li><p><strong>mimetype</strong> (<em>str</em>) – can be one of:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> on success, <cite>nil</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>nil</cite> on success, an error message in case of error.
Throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets a header in the request to the Service with the given value. Any existing header
with the same name will be overridden.
If the <cite>header</cite> argument is <cite>“host”</cite> (case-insensitive), then this also
sets the SNI of the request to the Service.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access, balancer</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_header(“X-Foo”, “value”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>str</em>) – The header name. Example: “X-Foo”.</p></li>
<li><p><strong>value</strong> (<em>Any</em>) – The header value. Example: “hello world”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the headers of the request to the Service. Unlike
<cite>kong.service.request.set_header()</cite>, the <cite>headers</cite> argument must be a table in
which each key is a string (corresponding to a header’s name), and each value
is a string, or an array of strings.
The resulting headers are produced in lexicographical order. The order of
entries with the same name (when values are given as an array) is retained.
This function overrides any existing header bearing the same name as those
specified in the <cite>headers</cite> argument. Other headers remain unchanged.
If the <cite>“Host”</cite> header is set (case-insensitive), then this also sets
the SNI of the request to the Service.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_header(“X-Foo”, “foo1”)</p>
<p>kong.service.request.add_header(“X-Foo”, “foo2”)</p>
<p>kong.service.request.set_header(“X-Bar”, “bar1”)</p>
<p>kong.service.request.set_headers({</p>
<p>[“X-Foo”] = “foo3”,</p>
<p>[“Cache-Control”] = { “no-store”, “no-cache” },</p>
<p>[“Bla”] = “boo”</p>
<p>})</p>
<p># Will add the following headers to the request, in this order:</p>
<p># X-Bar: bar1</p>
<p># Bla: boo</p>
<p># Cache-Control: no-store</p>
<p># Cache-Control: no-cache</p>
<p># X-Foo: foo3</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>headers</strong> (<em>table</em>) – A table where each key is a string containing a header name
and each value is either a string or an array of strings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_method">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_method" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the HTTP method for the request to the service.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_method(“DELETE”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>method</strong> (<em>str</em>) – The method string, which must be in all
uppercase. Supported values are: <cite>“GET”</cite>, <cite>“HEAD”</cite>, <cite>“PUT”</cite>, <cite>“POST”</cite>,
<cite>“DELETE”</cite>, <cite>“OPTIONS”</cite>, <cite>“MKCOL”</cite>, <cite>“COPY”</cite>, <cite>“MOVE”</cite>, <cite>“PROPFIND”</cite>,
<cite>“PROPPATCH”</cite>, <cite>“LOCK”</cite>, <cite>“UNLOCK”</cite>, <cite>“PATCH”</cite>, or <cite>“TRACE”</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_path" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the path component for the request to the service.
The input accepts any valid <em>normalized</em> URI (including UTF-8 characters)
and this API will perform necessary escaping according to the RFC
to make the request valid.
Input should <strong>not</strong> include the query string.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_path(“/v2/movies”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path string. Special characters and UTF-8
characters are allowed, for example: <cite>“/v2/movies”</cite> or <cite>“/foo/😀”</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Set the query string of the request to the Service.
Unlike <cite>kong.service.request.set_raw_query()</cite>, the <cite>query</cite> argument must be a
table in which each key is a string (corresponding to an argument’s name), and
each value is either a boolean, a string, or an array of strings or booleans.
Additionally, all string values will be URL-encoded.
The resulting query string contains keys in their lexicographical order. The
order of entries within the same key (when values are given as an array) is
retained.
If further control of the query string generation is needed, a raw query
string can be given as a string with <cite>kong.service.request.set_raw_query()</cite>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_query({</p>
<p>foo = “hello world”,</p>
<p>bar = {“baz”, “bla”, true},</p>
<p>zzz = true,</p>
<p>blo = “”</p>
<p>})</p>
<p># Produces the following query string:</p>
<p># bar=baz&amp;bar=bla&amp;bar&amp;blo=&amp;foo=hello%20world&amp;zzz</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>table</em>) – A table where each key is a string (corresponding to an
argument name), and each value is either a boolean, a string, or an array of
strings or booleans. Any string values given are URL-encoded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_raw_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_raw_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_raw_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the body of the request to the Service.
The <cite>body</cite> argument must be a string and will not be processed in any way.
This function also sets the <cite>Content-Length</cite> header appropriately. To set an
empty body, you can provide an empty string (<cite>“”</cite>) to this function.
For a higher-level function to set the body based on the request content type,
see <cite>kong.service.request.set_body()</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_raw_body(“Hello, world!”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>body</strong> (<em>str</em>) – The raw body.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_raw_query">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_raw_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_raw_query" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the query string of the request to the Service. The <cite>query</cite> argument is a
string (without the leading <cite>?</cite> character), and is not processed in any
way.
For a higher-level function to set the query string from a Lua table of
arguments, see <cite>kong.service.request.set_query()</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>rewrite, access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_raw_query(“zzz&amp;bar=baz&amp;bar=bla&amp;bar&amp;blo=&amp;foo=hello%20world”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – The raw querystring. Example:
<cite>“foo=bar&amp;bla&amp;baz=hello%20world”</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.request.set_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.request.set_scheme" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the protocol to use when proxying the request to the Service.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.request.set_scheme(“https”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scheme</strong> (<em>str</em>) – The scheme to be used. Supported values are <cite>“http”</cite> or <cite>“https”</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>throws an error on invalid inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.service.response">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">response</span></span><a class="headerlink" href="#kong.kong.service.response" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.response.get_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mimetype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.service.response.get_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the decoded buffered body.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Plugin needs to call kong.service.request.enable_buffering() on <cite>rewrite</cite></p>
<p># or <cite>access</cite> phase prior calling this function.</p>
<p>body = kong.service.response.get_body()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mimetype</strong> (<em>str</em>) – The MIME type of the response (if known).</p></li>
<li><p><strong>max_args</strong> (<em>number</em>) – Sets a limit on the maximum number of (what?)
that can be parsed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The raw buffered body</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.response.get_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#kong.kong.service.response.get_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the value of the specified response header.
Unlike <cite>kong.response.get_header()</cite>, this function only returns a header
if it is present in the response from the Service (ignoring headers added by Kong
itself).</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Given a response with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>kong.log.inspect(kong.service.response.get_header(“x-custom-header”)) # “bla”</p>
<p>kong.log.inspect(kong.service.response.get_header(“X-Another”))       # “foo bar”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the header.
Header names in are case-insensitive and are normalized to lowercase, and
dashes (<cite>-</cite>) can be written as underscores (<cite>_</cite>); that is, the header
<cite>X-Custom-Header</cite> can also be retrieved as <cite>x_custom_header</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the header, or <cite>nil</cite> if a header with
<cite>name</cite> is not found in the response. If a header with the same name is present
multiple times in the response, this function returns the value of the
first occurrence of this header.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.response.get_headers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.response.get_headers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a Lua table holding the headers from the Service response. Keys are
header names. Values are either a string with the header value, or an array of
strings if a header was sent multiple times. Header names in this table are
case-insensitive and dashes (<cite>-</cite>) can be written as underscores (<cite>_</cite>); that is,
the header <cite>X-Custom-Header</cite> can also be retrieved as <cite>x_custom_header</cite>.
Unlike <cite>kong.response.get_headers()</cite>, this function only returns headers that
are present in the response from the Service (ignoring headers added by Kong itself).
If the request is not proxied to a Service (e.g. an authentication plugin rejected
a request and produced an HTTP 401 response), then the returned <cite>headers</cite> value
might be <cite>nil</cite>, since no response from the Service has been received.
By default, this function returns up to <strong>100</strong> headers. The optional
<cite>max_headers</cite> argument can be specified to customize this limit, but must be
greater than <strong>1</strong> and not greater than <strong>1000</strong>.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Given a response with the following headers:</p>
<p># X-Custom-Header: bla</p>
<p># X-Another: foo bar</p>
<p># X-Another: baz</p>
<p>headers = kong.service.response.get_headers()</p>
<p>if headers:</p>
<blockquote>
<div><p>kong.log.inspect(headers.x_custom_header) # “bla”</p>
</div></blockquote>
<p>kong.log.inspect(headers.x_another[1])    # “foo bar”</p>
<p>kong.log.inspect(headers[“X-Another”][2]) # “baz”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_headers</strong> (<em>number</em>) – Sets a limit on the maximum number of
headers that can be parsed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The response headers in table form.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If more headers than <cite>max_headers</cite> are present, returns
a string with the error <cite>“truncated”</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.response.get_raw_body">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_raw_body</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="headerlink" href="#kong.kong.service.response.get_raw_body" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the raw buffered body.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p># Plugin needs to call kong.service.request.enable_buffering() on <cite>rewrite</cite></p>
<p># or <cite>access</cite> phase prior calling this function.</p>
<p>body = kong.service.response.get_raw_body()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The raw buffered body.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.response.get_status">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">number</span></span></span><a class="headerlink" href="#kong.kong.service.response.get_status" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns the HTTP status code of the response from the Service as a Lua number.</p>
</div></blockquote>
<dl class="simple">
<dt>Phases:</dt><dd><p>header_filter, body_filter, log</p>
</dd>
<dt>Example:</dt><dd><p>kong.log.inspect(kong.service.response.get_status()) # 418</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The status code from the response from the Service, or <cite>nil</cite>
if the request was not proxied (that is, if <cite>kong.response.get_source()</cite> returned
anything other than <cite>“service”</cite>).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.set_target">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#kong.kong.service.set_target" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the host and port on which to connect to for proxying the request.
Using this method is equivalent to ask Kong to not run the load-balancing
phase for this request, and consider it manually overridden.
Load-balancing components such as retries and health-checks will also be
ignored for this request.
The <cite>host</cite> argument expects the hostname or IP address of the upstream 
server, and the <cite>port</cite> expects a port number.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access</p>
</dd>
<dt>Example:</dt><dd><p>kong.service.set_target(“service.local”, 443)</p>
<p>kong.service.set_target(“192.168.130.1”, 80)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<em>str</em>) – </p></li>
<li><p><strong>port</strong> (<em>number</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.set_tls_verify">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_tls_verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.set_tls_verify" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets whether TLS verification is enabled while handshaking with the Service.
The <cite>on</cite> argument is a boolean flag, where <cite>true</cite> means upstream verification
is enabled and <cite>false</cite> disables it.
This call affects only the current request. If the trusted certificate store is
not set already (via [proxy_ssl_trusted_certificate](<a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_trusted_certificate">https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_trusted_certificate</a>)
or [kong.service.set_upstream_ssl_trusted_store](#kongserviceset_upstream_ssl_trusted_store)),
then TLS verification will always fail with “unable to get local issuer certificate” error.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, balancer, preread</p>
</dd>
<dt>Example:</dt><dd><p>ok, err = kong.service.set_tls_verify(true)</p>
<p>if not ok:</p>
<blockquote>
<div><p># do something with error</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>on</strong> (<em>bool</em>) – Whether to enable TLS certificate verification for the current request</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> if the operation succeeded, <cite>nil</cite> if an error occurred</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An error message describing the error if there was one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.set_tls_verify_depth">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_tls_verify_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.set_tls_verify_depth" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the maximum depth of verification when validating upstream server’s TLS certificate.
This call affects only the current request. For the depth to be actually used the verification
has to be enabled with either the [proxy_ssl_verify](<a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_verify">https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_verify</a>)
directive or using the [kong.service.set_tls_verify](#kongserviceset_tls_verify) function.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>rewrite, access, balancer, preread</p>
</dd>
<dt>Example:</dt><dd><p>ok, err = kong.service.set_tls_verify_depth(3)</p>
<p>if not ok:</p>
<blockquote>
<div><p># do something with error</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>depth</strong> (<em>number</em>) – Depth to use when validating. Must be non-negative</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> if the operation succeeded, <cite>nil</cite> if an error occurred</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An error message describing the error if there was one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.service.set_upstream">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.service.set_upstream" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Sets the desired Upstream entity to handle the load-balancing step for
this request. Using this method is equivalent to creating a Service with a
<cite>host</cite> property equal to that of an Upstream entity (in which case, the
request would be proxied to one of the Targets associated with that
Upstream).
The <cite>host</cite> argument should receive a string equal to the name of one of the
Upstream entities currently configured.</p>
</div></blockquote>
<dl>
<dt>Phases:</dt><dd><p>access</p>
</dd>
<dt>Example:</dt><dd><p>ok, err = kong.service.set_upstream(“service.prod”)</p>
<p>if not ok:</p>
<blockquote>
<div><p>kong.log.err(err)</p>
</div></blockquote>
<p>return</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>host</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> on success, or <cite>nil</cite> if no upstream entities
where found</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An error message describing the error if there was
one.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kong.kong.vault">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vault</span></span><a class="headerlink" href="#kong.kong.vault" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.vault.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.vault.get" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Resolves the passed in reference and returns the value of it.</p>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>value, err = kong.vault.get(“{vault://env/cert/key}”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to resolve</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>resolved value of the reference</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>error message on failure, otherwise <cite>nil</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.vault.is_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#kong.kong.vault.is_reference" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Checks if the passed in reference looks like a reference.
Valid references start with ‘{vault://’ and end with ‘}’.
If you need more thorough validation,
use <cite>kong.vault.parse_reference</cite>.</p>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><p>kong.vault.is_reference(“{vault://env/key}”) # true</p>
<p>kong.vault.is_reference(“not a reference”)   # false</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to check</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>true</cite> is the passed in reference looks like a reference, otherwise <cite>false</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kong.kong.vault.parse_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">table</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#kong.kong.vault.parse_reference" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Parses and decodes the passed in reference and returns a table
containing its components.
Given a following resource:
<code class="docutils literal notranslate"><span class="pre">`lua</span>
<span class="pre">&quot;{vault://env/cert/key?prefix=SSL_#1}&quot;</span>
<span class="pre">`</span></code>
This function will return following table:
<a href="#id217"><span class="problematic" id="id218">``</span></a><a href="#id219"><span class="problematic" id="id220">`</span></a>lua
{</p>
<blockquote>
<div><p>name     = “env”,  – name of the Vault entity or Vault strategy
resource = “cert”, – resource where secret is stored
key      = “key”,  – key to lookup if the resource is secret object
config   = {       – if there are any config options specified</p>
<blockquote>
<div><p>prefix = “<a href="#id223"><span class="problematic" id="id224">SSL_</span></a>”</p>
</div></blockquote>
<p>},
version  = 1       – if the version is specified</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>Example:</dt><dd><p>ref, err = kong.vault.parse_reference(“{vault://env/cert/key?prefix=SSL_#1}”) # table</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reference</strong> (<em>str</em>) – reference to parse</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a table containing each component of the reference, or <cite>nil</cite> on error</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>error message on failure, otherwise <cite>nil</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kong.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>